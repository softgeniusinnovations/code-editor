import{r,j as e}from"./react-xe4jsmfW.js";import{a as it}from"./react-dom-CDP_2C_w.js";import{B as at}from"./react-router-dom-CZaejiF4.js";import{F as lt,n as I,z as L}from"./react-hot-toast-BWCWS8kw.js";import{l as ct}from"./socket.io-client-BM-Eb1Rs.js";import{L as dt,a as je,b as ut,c as mt,R as ft,d as pt,e as ht,A as xt,f as gt,P as _e,M as Pe,T as wt,B as bt,g as Me,I as Ct,G as yt,h as Et,i as Nt,j as vt,k as jt,l as St,m as Rt,n as De,o as It,p as Dt,q as kt}from"./react-icons-CQCycJKn.js";import{v as V}from"./uuid-CtRu48qb.js";import{a as Se}from"./axios-B9ygI19o.js";import{F as Ot}from"./file-saver-DXLm0zc3.js";import{J as Tt}from"./jszip-BYW2XS47.js";import{M as Lt}from"./react-markdown-Cuyo6ip9.js";import{h as At,d as Ft}from"./react-syntax-highlighter-DMpjYQye.js";import{I as _t}from"./vscode-icons-js-DUdIxQfY.js";import{I as Ue}from"./@iconify-INkOFpyZ.js";import{c as ae}from"./classnames-Dty2DWCt.js";import{l as He}from"./lang-map-nLg5Kdxm.js";import{x as Pt,a as Mt,w as Ut,b as Ht,v as zt,t as Gt,c as Wt,d as Jt,e as $t,s as Yt,f as Vt,g as Bt,r as qt,q as Qt,o as Kt,n as Xt,h as Zt,m as es,i as ts,j as ss,k as ns,l as os,p as rs,u as is,y as as,z as ls,A as cs,B as ds,C as us,D as ms,E as fs,F as ps,G as hs,H as xs,I as gs,J as ws,K as bs,L as Cs,M as ys,N as Es,O as Ns,P as vs,Q as js,R as Ss,S as Rs,T as Is,U as Ds,V as ks}from"./@uiw-C3tmGjRq.js";import{A as Os}from"./react-avatar-CEX1TIQS.js";import{u as we,a as Ts,b as ze,c as Ls,d as ke}from"./react-router-BRbsMqEq.js";import{S as As}from"./react-split-s72OsX8P.js";import{M as Ne}from"./react-tooltip-DN-mCcUm.js";import"./core-js-C7DbFKwg.js";import{u as Fs}from"./@tldraw-p3oJsSm0.js";import"./lodash.throttle-yuuEgjvB.js";import"./lodash.uniq-u0GOvbqz.js";import"./lodash.isequal-CX3c-88x.js";import"./idb-Bn1DMRyg.js";import{T as _s}from"./tldraw-DKVnECBa.js";import"./lz-string-DQU_J7vJ.js";import"./hotkeys-js-BxEwhL3V.js";import{bQ as Ps,bR as Ms,E as Re,bj as xe,bk as Us,bS as Hs}from"./@codemirror-D8nkFkXT.js";import{s as Oe}from"./screenfull-DmVOzVZz.js";import"./charenc-CI8Jn5z4.js";import"./scheduler-CoSDG3-6.js";import"./@remix-run-BpfYDNJ8.js";import"./goober-wofAfydu.js";import"./engine.io-client-CfqhKr8h.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./devlop-Cl3hj7Sz.js";import"./unified-BVfCCR4t.js";import"./bail-FqpXQuLt.js";import"./extend-D1C0LVzC.js";import"./is-plain-obj-C1gvLhAf.js";import"./trough-B_b8ryxu.js";import"./vfile-DoIswyph.js";import"./vfile-message-Ezj_CYSE.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./remark-parse-C8jcMe6G.js";import"./mdast-util-from-markdown-CgCUhJTR.js";import"./micromark-util-decode-numeric-character-reference-CNs1qBpV.js";import"./micromark-util-decode-string-strjl-tx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-DhRKOnvZ.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-CA-Wq7KA.js";import"./micromark-util-character-Ch8j4vtg.js";import"./micromark-core-commonmark-CDnWrFBr.js";import"./micromark-util-classify-character-GCpR5yWH.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./micromark-util-subtokenize-BC4BSQ9J.js";import"./micromark-factory-destination-CkgxUJuk.js";import"./micromark-factory-label-U15tx9Nh.js";import"./micromark-factory-title-reCpaPbc.js";import"./micromark-factory-whitespace-_v4v79HM.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./mdast-util-to-string-C_aolqmU.js";import"./remark-rehype-lIbojaYD.js";import"./mdast-util-to-hast-C1lZlDm6.js";import"./@ungap--gfxRhYI.js";import"./micromark-util-sanitize-uri-WGc3xW3f.js";import"./unist-util-position-60F3QETU.js";import"./trim-lines-D8znQY54.js";import"./unist-util-visit-CWHsnU7X.js";import"./unist-util-visit-parents-DZMunsV6.js";import"./unist-util-is-BPZGFiMU.js";import"./hast-util-to-jsx-runtime-CPS_PIgD.js";import"./comma-separated-tokens-xMQ5YY98.js";import"./property-information-Bx45xMUt.js";import"./space-separated-tokens-DD3iYX1K.js";import"./style-to-js-BPjnuCk7.js";import"./style-to-object-Cg2xzs12.js";import"./inline-style-parser-BlqBsVO4.js";import"./hast-util-whitespace-D4Wp6AEg.js";import"./estree-util-is-identifier-name-BgBfM8ME.js";import"./html-url-attributes-D46m5wfe.js";import"./@babel-pqmwtNTb.js";import"./refractor-De9CcUcl.js";import"./hastscript-Cxyc55ZY.js";import"./xtend-VQg9yHl6.js";import"./hast-util-parse-selector-BXt8oe2z.js";import"./parse-entities-C6euGolz.js";import"./character-reference-invalid-AKrgFUtc.js";import"./is-decimal-Bg2oiju0.js";import"./is-hexadecimal-yh8m6GRc.js";import"./is-alphanumerical-_oBzrqVk.js";import"./is-alphabetical-BQ1fjZEF.js";import"./@lezer-Bc0n9ZzW.js";import"./@replit-Z3Y5JSVX.js";import"./colors-named-CSGyx1iI.js";import"./colors-named-hex-Db6HdBCI.js";import"./hsl-matcher-CyxH9sTP.js";import"./prop-types-yNpOvJnk.js";import"./is-retina-BzLP6e3E.js";import"./md5-d1KzqBq9.js";import"./crypt-C-Yx0DM0.js";import"./is-buffer-DMJNLjvk.js";import"./split.js-CPyVEc61.js";import"./@floating-ui-Dttr1Bto.js";import"./nanoid-vcSNLBTf.js";import"./@use-gesture-DOFCekvX.js";import"./eventemitter3-Dqjbdtcb.js";import"./@radix-ui-7FXfGXGO.js";import"./react-remove-scroll-DaQnJUT6.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-wXCc6S34.js";import"./react-style-singleton-C2vgJe_j.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-DjRnOWoj.js";import"./use-callback-ref-B2lVNl4n.js";import"./aria-hidden-DvXkyWUv.js";import"./canvas-size-By42e4U-.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bs6eFhZE.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();function Ge(){return{setItem:(o,a)=>{localStorage.setItem(o,a)},getItem:o=>localStorage.getItem(o),removeItem:o=>{localStorage.removeItem(o)}}}const We=r.createContext(null),pe=()=>{const t=r.useContext(We);if(!t)throw new Error("useSettings must be used within a SettingContextProvider");return t},K={theme:"Dracula",language:"Javascript",fontSize:16,fontFamily:"Space Mono",showGitHubCorner:!0};function zs({children:t}){const{getItem:s}=Ge(),n=JSON.parse(s("settings")||"{}"),o=n.theme!==void 0?n.theme:K.theme,a=n.language!==void 0?n.language:K.language,i=n.fontSize!==void 0?n.fontSize:K.fontSize,l=n.fontFamily!==void 0?n.fontFamily:K.fontFamily,c=n.showGitHubCorner!==void 0?n.showGitHubCorner:K.showGitHubCorner,[d,g]=r.useState(o),[w,u]=r.useState(a),[p,x]=r.useState(i),[h,v]=r.useState(l),[S,E]=r.useState(c),P=()=>{g(K.theme),u(K.language),x(K.fontSize),v(K.fontFamily),E(K.showGitHubCorner)};return r.useEffect(()=>{const A={theme:d,language:w,fontSize:p,fontFamily:h,showGitHubCorner:S};localStorage.setItem("settings",JSON.stringify(A))},[d,w,p,h,S]),e.jsx(We.Provider,{value:{theme:d,setTheme:g,language:w,setLanguage:u,fontSize:p,setFontSize:x,fontFamily:h,setFontFamily:v,showGitHubCorner:S,setShowGitHubCorner:E,resetSettings:P},children:t})}function re(){const[t,s]=r.useState({width:window.innerWidth,height:window.innerHeight}),[n,o]=r.useState(window.innerWidth<768);return r.useEffect(()=>{const a=()=>{s({width:window.innerWidth,height:window.innerHeight}),o(window.innerWidth<768)};return window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]),{...t,isMobile:n}}function Gs(){const{showGitHubCorner:t}=pe(),{width:s}=re();return e.jsx("a",{href:"https://github.com/smshagor-dev",className:"github-corner","aria-label":"View source on GitHub",target:"_blank",rel:"noreferrer",style:{display:t&&s>640?"block":"none"},children:e.jsx("svg",{width:"150",height:"100",viewBox:"0 0 250 250",className:"absolute right-0 top-0 z-10 border-none bg-primary text-gray-900 dark:text-gray-100","aria-hidden":"true",style:{color:"#151513",transform:"rotate(45deg) translate(12%,-80%) scale(0.8)"},children:e.jsxs("g",{style:{transform:"rotate(-45deg) translate(0%,50%)",transformOrigin:"bottom"},children:[e.jsx("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{transformOrigin:"130px 106px"},className:"octo-arm"}),e.jsx("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",className:"octo-body"})]})})})}function Ws(){return e.jsx(lt,{position:"top-right"})}var X=(t=>(t.CODING="coding",t.DRAWING="drawing",t))(X||{}),fe=(t=>(t.OFFLINE="offline",t.ONLINE="online",t))(fe||{}),U=(t=>(t.INITIAL="initial",t.CONNECTING="connecting",t.ATTEMPTING_JOIN="attempting-join",t.JOINED="joined",t.CONNECTION_FAILED="connection-failed",t.DISCONNECTED="disconnected",t))(U||{});const Je=r.createContext(null),J=()=>{const t=r.useContext(Je);if(t===null)throw new Error("useAppContext must be used within a AppContextProvider");return t};function Js({children:t}){const[s,n]=r.useState([]),[o,a]=r.useState(U.INITIAL),[i,l]=r.useState({username:"",roomId:""}),[c,d]=r.useState(X.CODING),[g,w]=r.useState(null),[u,p]=r.useState(null);return e.jsx(Je.Provider,{value:{users:s,setUsers:n,currentUser:i,setCurrentUser:l,status:o,setStatus:a,activityState:c,setActivityState:d,drawingData:g,setDrawingData:w,roomId:u,setRoomId:p},children:t})}var f=(t=>(t.JOIN_REQUEST="join-request",t.JOIN_ACCEPTED="join-accepted",t.USER_JOINED="user-joined",t.USER_DISCONNECTED="user-disconnected",t.SYNC_FILE_STRUCTURE="sync-file-structure",t.DIRECTORY_CREATED="directory-created",t.DIRECTORY_UPDATED="directory-updated",t.DIRECTORY_RENAMED="directory-renamed",t.DIRECTORY_DELETED="directory-deleted",t.FILE_CREATED="file-created",t.FILE_UPDATED="file-updated",t.FILE_RENAMED="file-renamed",t.FILE_DELETED="file-deleted",t.USER_OFFLINE="offline",t.USER_ONLINE="online",t.SEND_MESSAGE="send-message",t.RECEIVE_MESSAGE="receive-message",t.TYPING_START="typing-start",t.TYPING_PAUSE="typing-pause",t.CURSOR_MOVE="cursor-move",t.USERNAME_EXISTS="username-exists",t.REQUEST_DRAWING="request-drawing",t.SYNC_DRAWING="sync-drawing",t.DRAWING_UPDATE="drawing-update",t.PASSWORD_REQUIRED="password-required",t.PASSWORD_INCORRECT="password-incorrect",t.ROOM_INFO_REQUEST="room-info-request",t.ROOM_INFO_RESPONSE="room-info-response",t.CHECK_ROOM_PASSWORD="check-room-password",t.PASSWORD_VALID="password-valid",t.ERROR="error",t.ROOM_CREATED="room-created",t.CREATE_ROOM="create-room",t.FILE_STRUCTURE_LOADED="file-structure-loaded",t.FILE_CONTENT_LOADED="file-content-loaded",t.LOAD_FILE_STRUCTURE="load-file-structure",t.LOAD_FILE_CONTENT="load-file-content",t.LOAD_CHAT_HISTORY="load_chat_history",t.CHAT_HISTORY_LOADED="chat_history_loaded",t))(f||{});const $e=r.createContext(null),B=()=>{const t=r.useContext($e);if(!t)throw new Error("useSocket must be used within a SocketProvider");return t},$s="https://cloud.code-editor.ru",Ys=({children:t})=>{const{users:s,setUsers:n,setStatus:o,setCurrentUser:a,drawingData:i,setDrawingData:l}=J(),c=r.useMemo(()=>ct($s,{reconnectionAttempts:2}),[]),d=r.useCallback(h=>{console.log("socket error",h),o(U.CONNECTION_FAILED),I.dismiss(),I.error("Failed to connect to the server")},[o]),g=r.useCallback(()=>{I.dismiss(),o(U.INITIAL),I.error("The username you chose already exists in the room. Please choose a different username.")},[o]),w=r.useCallback(({user:h,users:v})=>{a(h),n(v),I.dismiss(),o(U.JOINED),v.length>1&&I.loading("Syncing data, please wait...")},[a,o,n]),u=r.useCallback(({user:h})=>{I.success(`${h.username} left the room`),n(s.filter(v=>v.username!==h.username))},[n,s]),p=r.useCallback(({socketId:h})=>{c.emit(f.SYNC_DRAWING,{socketId:h,drawingData:i})},[i,c]),x=r.useCallback(({drawingData:h})=>{l(h)},[l]);return r.useEffect(()=>(c.on("connect_error",d),c.on("connect_failed",d),c.on(f.USERNAME_EXISTS,g),c.on(f.JOIN_ACCEPTED,w),c.on(f.USER_DISCONNECTED,u),c.on(f.REQUEST_DRAWING,p),c.on(f.SYNC_DRAWING,x),()=>{c.off("connect_error"),c.off("connect_failed"),c.off(f.USERNAME_EXISTS),c.off(f.JOIN_ACCEPTED),c.off(f.USER_DISCONNECTED),c.off(f.REQUEST_DRAWING),c.off(f.SYNC_DRAWING)}),[x,d,w,p,u,g,n,c]),e.jsx($e.Provider,{value:{socket:c},children:t})},Ye=r.createContext(null),Ie=()=>{const t=r.useContext(Ye);if(!t)throw new Error("useChatRoom must be used within a ChatContextProvider");return t};function Vs({children:t}){const{socket:s}=B(),[n,o]=r.useState([]),[a,i]=r.useState(!1),[l,c]=r.useState(0);return r.useEffect(()=>(s.on(f.RECEIVE_MESSAGE,({message:d})=>{o(g=>[...g,d]),i(!0)}),()=>{s.off(f.RECEIVE_MESSAGE)}),[s]),r.useEffect(()=>{if(s)return s.emit(f.LOAD_CHAT_HISTORY),s.on(f.CHAT_HISTORY_LOADED,({messages:d})=>{o(d)}),()=>{s.off(f.CHAT_HISTORY_LOADED)}},[s]),e.jsx(Ye.Provider,{value:{messages:n,setMessages:o,isNewMessage:a,setIsNewMessage:i,lastScrollHeight:l,setLastScrollHeight:c},children:t})}function Bs(t){const s=new Date(t);let n=s.getHours();const o=String(s.getMinutes()).padStart(2,"0"),a=n>=12?"PM":"AM";return n=n%12,n=n||12,`${n}:${o} ${a}`}function qs(){const{currentUser:t}=J(),{socket:s}=B(),{setMessages:n}=Ie(),o=r.useRef(null),a=i=>{var c;i.preventDefault();const l=(c=o.current)==null?void 0:c.value.trim();if(l&&l.length>0){const d={id:V(),message:l,username:t.username,timestamp:Bs(new Date().toISOString())};s.emit(f.SEND_MESSAGE,{message:d}),n(g=>[...g,d]),o.current&&(o.current.value="")}};return e.jsxs("form",{onSubmit:a,className:"flex justify-between rounded-md border border-primary",children:[e.jsx("input",{type:"text",className:"w-full flex-grow rounded-md border-none bg-dark p-2 outline-none",placeholder:"Enter a message...",ref:o}),e.jsx("button",{className:"flex items-center justify-center rounded-r-md  bg-primary p-2 text-black",type:"submit",children:e.jsx(dt,{size:24})})]})}function Qs(){const{messages:t,isNewMessage:s,setIsNewMessage:n,lastScrollHeight:o,setLastScrollHeight:a}=Ie(),{currentUser:i}=J(),l=r.useRef(null),c=d=>{const g=d.target;a(g.scrollTop)};return r.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[t]),r.useEffect(()=>{s&&n(!1),l.current&&(l.current.scrollTop=o)},[s,n,o]),e.jsx("div",{className:"flex-grow overflow-auto rounded-md bg-darkHover p-2",ref:l,onScroll:c,children:t.map((d,g)=>e.jsxs("div",{className:"mb-2 w-[80%] self-end break-words rounded-md bg-dark px-3 py-2"+(d.username===i.username?" ml-auto ":""),children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xs text-primary",children:d.username}),e.jsx("span",{className:"text-xs text-white",children:d.timestamp})]}),e.jsx("p",{className:"py-1",children:d.message})]},g))})}function Y(){const[t,s]=r.useState(!1),{height:n,isMobile:o}=re(),[a,i]=r.useState(n);return r.useEffect(()=>{n<500&&o?(s(!0),i(n)):o?(s(!1),i(n-50)):(s(!1),i(n))},[n,o,a]),{viewHeight:a,minHeightReached:t}}const Ks=()=>{const{viewHeight:t}=Y();return e.jsxs("div",{className:"flex max-h-full min-h-[400px] w-full flex-col gap-2 p-4",style:{height:t},children:[e.jsx("h1",{className:"view-title",children:"Group Chat"}),e.jsx(Qs,{}),e.jsx(qs,{})]})},Xs="https://text.pollinations.ai",Zs=Se.create({baseURL:Xs,headers:{"Content-Type":"application/json"}}),Ve=r.createContext(null),en=()=>{const t=r.useContext(Ve);if(t===null)throw new Error("useCopilot must be used within a CopilotContextProvider");return t},tn=({children:t})=>{const[s,n]=r.useState(""),[o,a]=r.useState(""),[i,l]=r.useState(!1),c=async()=>{try{if(s.length===0){L.error("Please write a prompt");return}L.loading("Generating code..."),l(!0);const d=await Zs.post("/",{messages:[{role:"system",content:"You are a code generator copilot for project named Code Editor. Generate code based on the given prompt without any explanation. Return only the code, formatted in Markdown using the appropriate language syntax (e.g., js for JavaScript, py for Python). Do not include any additional text or explanations. If you don't know the answer, respond with 'I don't know'."},{role:"user",content:s}],model:"mistral",private:!0});if(d.data){L.success("Code generated successfully");const g=d.data;g&&a(g)}l(!1),L.dismiss()}catch(d){console.error(d),l(!1),L.dismiss(),L.error("Failed to generate the code")}};return e.jsx(Ve.Provider,{value:{setInput:n,output:o,isRunning:i,generateCode:c},children:t})},sn=`function sayHi() {
  console.log("ðŸ‘‹ Hello world");
}

sayHi()`,Ce={name:"root",id:V(),type:"directory",children:[{id:V(),type:"file",name:"index.js",content:sn}]},Be=(t,s)=>{if(t.id===s&&t.type==="directory")return t;if(t.type==="directory"&&t.children)for(const n of t.children){const o=Be(n,s);if(o)return o}return null},Te=(t,s)=>t.children?t.children.some(n=>n.name===s):!1,nn=(t,s)=>{const n=o=>{if(o.id===s)return o;if(o.children)for(const a of o.children){const i=n(a);if(i)return i}return null};return n(t)},qe=t=>{if(t.type==="directory"&&t.children){let s=t.children.filter(o=>o.type==="directory");const n=t.children.filter(o=>o.type==="file");s.sort((o,a)=>o.name.localeCompare(a.name)),s=s.map(o=>qe(o)),n.sort((o,a)=>o.name.localeCompare(a.name)),t.children=[...s.filter(o=>o.name.startsWith(".")),...s.filter(o=>!o.name.startsWith(".")),...n.filter(o=>o.name.startsWith(".")),...n.filter(o=>!o.name.startsWith("."))]}return t},Qe=r.createContext(null),Z=()=>{const t=r.useContext(Qe);if(!t)throw new Error("useFileSystem must be used within FileContextProvider");return t};function on({children:t}){const{socket:s}=B(),{setUsers:n,drawingData:o,roomId:a,setRoomId:i}=J(),[l,c]=r.useState(Ce),d=l.children?l.children:[],[g,w]=r.useState(d),[u,p]=r.useState(g[0]),[x,h]=r.useState(new Set),[v,S]=r.useState(!1);r.useEffect(()=>{a&&!v&&(console.log("Loading files for room:",a),s.emit(f.LOAD_FILE_STRUCTURE,{roomId:a}),S(!0))},[a,v,s]),r.useEffect(()=>{a||(console.log("Room ID cleared, resetting file structure"),c(Ce),w([]),p(null),S(!1),h(new Set))},[a]),r.useEffect(()=>{const m=y=>{var C,N;console.log("Join accepted, setting roomId:",(C=y.user)==null?void 0:C.roomId),i(((N=y.user)==null?void 0:N.roomId)||null),S(!1)},b=y=>{console.log("Room created, setting roomId:",y.roomId),i(y.roomId||null),S(!1)};return s.on(f.JOIN_ACCEPTED,m),s.on(f.ROOM_CREATED,b),()=>{s.off(f.JOIN_ACCEPTED,m),s.off(f.ROOM_CREATED,b)}},[s,i]);const E=m=>{const b=y=>y.id===m?{...y,isOpen:!y.isOpen}:y.children?{...y,children:y.children.map(b)}:y;c(y=>b(y))},P=()=>{const m=b=>{var y;return{...b,isOpen:!1,children:(y=b.children)==null?void 0:y.map(m)}};c(b=>m(b))},A=r.useCallback((m,b,y=!0)=>{let C;typeof b=="string"?C={id:V(),name:b,type:"directory",children:[],isOpen:!1}:C=b,m||(m=l.id);const N=j=>j.id===m?{...j,children:[...j.children||[],C]}:j.children?{...j,children:j.children.map(N)}:j;return c(j=>N(j)),y&&s.emit(f.DIRECTORY_CREATED,{parentDirId:m,newDirectory:C}),C.id},[l.id,s]),G=r.useCallback((m,b,y=!0)=>{m||(m=l.id);const C=N=>N.id===m?{...N,children:b}:N.children?{...N,children:N.children.map(C)}:N;c(N=>C(N)),w([]),p(null),m===l.id&&(I.dismiss(),I.success("Files and folders updated")),y&&s.emit(f.DIRECTORY_UPDATED,{dirId:m,children:b})},[l.id,s]),_=r.useCallback((m,b,y=!0)=>{const C=j=>j.type==="directory"&&j.children?j.children.some(O=>O.type==="directory"&&O.name===b&&O.id!==m)?null:{...j,children:j.children.map(O=>{if(O.id===m)return{...O,name:b};if(O.type==="directory"){const me=C(O);return me!==null?me:O}else return O})}:j,N=C(l);return N===null?!1:(c(N),y&&s.emit(f.DIRECTORY_RENAMED,{dirId:m,newDirName:b}),!0)},[s,c,l]),W=r.useCallback((m,b=!0)=>{const y=C=>{if(C.type==="directory"&&C.id===m)return null;if(C.children){const N=C.children.map(y).filter(j=>j!==null);return{...C,children:N}}else return C};c(C=>y(C)),b&&s.emit(f.DIRECTORY_DELETED,{dirId:m})},[s]),ne=m=>{const b=nn(l,m);b&&(D((u==null?void 0:u.id)||"",(u==null?void 0:u.content)||""),g.some(y=>y.id===m)||w(y=>[...y,b]),w(y=>y.map(C=>C.id===(u==null?void 0:u.id)?{...C,content:u.content||""}:C)),p(b),b.type==="file"&&(!b.content||b.content==="")&&!x.has(m)&&(console.log("Requesting file content from server:",m),h(y=>new Set(y).add(m)),s.emit(f.LOAD_FILE_CONTENT,{fileId:m})))},$=m=>{if(m===(u==null?void 0:u.id)){D(u.id,u.content||"");const b=g.findIndex(y=>y.id===m);b!==-1&&g.length>1?b>0?p(g[b-1]):p(g[b+1]):p(null)}w(b=>b.filter(y=>y.id!==m))},R=r.useCallback((m,b,y=!0)=>{let C=1;m||(m=l.id);const N=Be(l,m);if(!N)throw new Error("Parent directory not found");let j;if(typeof b=="string"){let O=b,me=Te(N,O);for(;me;)O=`${O.split(".")[0]}(${C}).${O.split(".")[1]}`,me=Te(N,O),C++;j={id:V(),name:O,type:"file",content:""}}else j=b;const z=O=>O.id===N.id?{...O,children:[...O.children||[],j],isOpen:!0}:O.children?{...O,children:O.children.map(z)}:O;return c(O=>z(O)),w(O=>[...O,j]),p(j),y&&s.emit(f.FILE_CREATED,{parentDirId:m,newFile:j}),j.id},[l,s]),D=r.useCallback((m,b)=>{const y=C=>C.type==="file"&&C.id===m?{...C,content:b}:C.children?{...C,children:C.children.map(y)}:C;c(C=>y(C)),g.some(C=>C.id===m)&&w(C=>C.map(N=>N.id===m?{...N,content:b}:N))},[g]),H=r.useCallback((m,b,y=!0)=>{const C=N=>N.type==="directory"&&N.children?{...N,children:N.children.map(j=>j.type==="file"&&j.id===m?{...j,name:b}:j)}:N;return c(N=>C(N)),w(N=>N.map(j=>j.id===m?{...j,name:b}:j)),m===(u==null?void 0:u.id)&&p(N=>N?{...N,name:b}:null),y&&s.emit(f.FILE_RENAMED,{fileId:m,newName:b}),!0},[u==null?void 0:u.id,s]),F=r.useCallback((m,b=!0)=>{const y=C=>{if(C.type==="directory"&&C.children){const N=C.children.map(j=>j.type==="directory"?y(j):j.id!==m?j:null).filter(j=>j!==null);return{...C,children:N}}else return C};c(C=>y(C)),g.some(C=>C.id===m)&&w(C=>C.filter(N=>N.id!==m)),(u==null?void 0:u.id)===m&&p(null),I.success("File deleted successfully"),b&&s.emit(f.FILE_DELETED,{fileId:m})},[u==null?void 0:u.id,g,s]),q=()=>{const m=new Tt,b=(y,C="")=>{const N=C+y.name+(y.type==="directory"?"/":"");if(y.type==="file")m.file(N,y.content||"");else if(y.type==="directory"&&y.children)for(const j of y.children)b(j,N)};if(l.type==="directory"&&l.children)for(const y of l.children)b(y);m.generateAsync({type:"blob"}).then(y=>{Ot.saveAs(y,"download.zip")})},te=r.useCallback(({fileStructure:m})=>{console.log("Room file structure loaded from server:",m),c(m);const b=m.children?m.children.filter(y=>y.type==="file"):[];w(b),b.length>0?p(b[0]):p(null),h(new Set)},[]),se=r.useCallback(({fileId:m,content:b})=>{console.log("File content loaded from server:",m,b),h(C=>{const N=new Set(C);return N.delete(m),N});const y=C=>C.type==="file"&&C.id===m?{...C,content:b}:C.children?{...C,children:C.children.map(y)}:C;c(C=>y(C)),w(C=>C.map(N=>N.id===m?{...N,content:b}:N)),(u==null?void 0:u.id)===m&&p(C=>C?{...C,content:b}:null)},[u==null?void 0:u.id]);r.useEffect(()=>()=>{h(new Set)},[]),r.useEffect(()=>{s.emit(f.LOAD_FILE_STRUCTURE),console.log("Requested room file structure from server")},[s]),r.useEffect(()=>{a&&!v&&(console.log("Loading files for room:",a),s.emit(f.LOAD_FILE_STRUCTURE,{roomId:a}),S(!0))},[a,v,s]),r.useEffect(()=>()=>{h(new Set)},[]),r.useEffect(()=>{a||(console.log("Room ID cleared, resetting file structure"),c(Ce),w([]),p(null),S(!1),h(new Set))},[a]);const ee=r.useCallback(({user:m})=>{I.success(`${m.username} joined the room`),s.emit(f.SYNC_FILE_STRUCTURE,{fileStructure:l,openFiles:g,activeFile:u,socketId:m.socketId}),s.emit(f.SYNC_DRAWING,{drawingData:o,socketId:m.socketId}),n(b=>[...b,m])},[u,o,l,g,n,s]),Q=r.useCallback(({fileStructure:m,openFiles:b,activeFile:y})=>{c(m),w(b),p(y),I.dismiss()},[]),oe=r.useCallback(({parentDirId:m,newDirectory:b})=>{A(m,b,!1)},[A]),le=r.useCallback(({dirId:m,children:b})=>{G(m,b,!1)},[G]),he=r.useCallback(({dirId:m,newName:b})=>{_(m,b,!1)},[_]),ce=r.useCallback(({dirId:m})=>{W(m,!1)},[W]),de=r.useCallback(({parentDirId:m,newFile:b})=>{R(m,b,!1)},[R]),ue=r.useCallback(({fileId:m,newContent:b})=>{D(m,b),(u==null?void 0:u.id)===m&&p({...u,content:b})},[u,D]),k=r.useCallback(({fileId:m,newName:b})=>{H(m,b,!1)},[H]),M=r.useCallback(({fileId:m})=>{F(m,!1)},[F]);return r.useEffect(()=>(s.once(f.SYNC_FILE_STRUCTURE,Q),s.on(f.USER_JOINED,ee),s.on(f.DIRECTORY_CREATED,oe),s.on(f.DIRECTORY_UPDATED,le),s.on(f.DIRECTORY_RENAMED,he),s.on(f.DIRECTORY_DELETED,ce),s.on(f.FILE_CREATED,de),s.on(f.FILE_UPDATED,ue),s.on(f.FILE_RENAMED,k),s.on(f.FILE_DELETED,M),s.on(f.FILE_STRUCTURE_LOADED,te),s.on(f.FILE_CONTENT_LOADED,se),()=>{s.off(f.USER_JOINED),s.off(f.DIRECTORY_CREATED),s.off(f.DIRECTORY_UPDATED),s.off(f.DIRECTORY_RENAMED),s.off(f.DIRECTORY_DELETED),s.off(f.FILE_CREATED),s.off(f.FILE_UPDATED),s.off(f.FILE_RENAMED),s.off(f.FILE_DELETED),s.off(f.FILE_STRUCTURE_LOADED),s.off(f.FILE_CONTENT_LOADED)}),[oe,ce,he,le,de,M,k,Q,ue,ee,te,se,s]),e.jsx(Qe.Provider,{value:{fileStructure:l,openFiles:g,activeFile:u,setActiveFile:p,closeFile:$,toggleDirectory:E,collapseDirectories:P,createDirectory:A,updateDirectory:G,renameDirectory:_,deleteDirectory:W,openFile:ne,createFile:R,updateFileContent:D,renameFile:H,deleteFile:F,downloadFilesAndFolders:q},children:t})}function rn(){const{socket:t}=B(),{viewHeight:s}=Y(),{generateCode:n,output:o,isRunning:a,setInput:i}=en(),{activeFile:l,updateFileContent:c,setActiveFile:d}=Z(),g=async()=>{try{const p=o.replace(/```[\w]*\n?/g,"").trim();await navigator.clipboard.writeText(p),L.success("Output copied to clipboard")}catch(p){L.error("Unable to copy output to clipboard"),console.log(p)}},w=()=>{if(l){const x=`${l.content?`${l.content}
`:""}${o.replace(/```[\w]*\n?/g,"").trim()}`;c(l.id,x),d({...l,content:x}),L.success("Code pasted successfully"),t.emit(f.FILE_UPDATED,{fileId:l.id,newContent:x})}},u=()=>{if(l){if(!confirm("Are you sure you want to replace the code in the file?"))return;const x=o.replace(/```[\w]*\n?/g,"").trim();c(l.id,x),d({...l,content:x}),L.success("Code replaced successfully"),t.emit(f.FILE_UPDATED,{fileId:l.id,newContent:x})}};return e.jsxs("div",{className:"flex max-h-full min-h-[400px] w-full flex-col gap-2 p-4",style:{height:s},children:[e.jsx("h1",{className:"view-title",children:"Copilot"}),e.jsx("textarea",{className:"min-h-[120px] w-full rounded-md border-none bg-darkHover p-2 text-white outline-none",placeholder:"What code do you want to generate?",onChange:p=>i(p.target.value)}),e.jsx("button",{className:"mt-1 flex w-full justify-center rounded-md bg-primary p-2 font-bold text-black outline-none disabled:cursor-not-allowed disabled:opacity-50",onClick:n,disabled:a,children:a?"Generating...":"Generate Code"}),o&&e.jsxs("div",{className:"flex justify-end gap-4 pt-2",children:[e.jsx("button",{title:"Copy Output",onClick:g,children:e.jsx(je,{size:18,className:"cursor-pointer text-white"})}),e.jsx("button",{title:"Replace code in file",onClick:u,children:e.jsx(ut,{size:18,className:"cursor-pointer text-white"})}),e.jsx("button",{title:"Paste code in file",onClick:w,children:e.jsx(mt,{size:18,className:"cursor-pointer text-white"})})]}),e.jsx("div",{className:"h-full rounded-lg w-full overflow-y-auto p-0",children:e.jsx(Lt,{components:{code({inline:p,className:x,children:h,...v}){const S=/language-(\w+)/.exec(x||""),E=S?S[1]:"javascript";return p?e.jsx("code",{className:x,...v,children:h}):e.jsx(At,{style:Ft,language:E,PreTag:"pre",className:"!m-0 !h-full !rounded-lg !bg-gray-900 !p-2",children:String(h).replace(/\n$/,"")})},pre({children:p}){return e.jsx("pre",{className:"h-full",children:p})}},children:o})})]})}const Ke=({ref:t})=>{const[s,n]=r.useState(!1),[o,a]=r.useState({x:0,y:0});return r.useEffect(()=>{const i=t.current;if(!i)return;const l=()=>{n(!1)},c=g=>{t.current&&t.current.contains(g.target)?(n(!0),a({x:g.pageX,y:g.pageY})):n(!1)},d=g=>{g.preventDefault(),n(!0),a({x:g.pageX,y:g.pageY})};return i.addEventListener("contextmenu",d),document.addEventListener("click",l),document.addEventListener("contextmenu",c),()=>{i.removeEventListener("contextmenu",d),document.removeEventListener("click",l),document.removeEventListener("contextmenu",c)}},[t]),{menuOpen:s,setMenuOpen:n,coords:o,setCoords:a}},Xe=t=>{var o;return`vscode-icons:${(o=_t.getIconForFile(t))==null?void 0:o.replace(/_/g,"-").split(".")[0]}`};function Ze({id:t,preName:s,setEditing:n,type:o}){const[a,i]=r.useState(s||""),{renameFile:l,openFile:c,renameDirectory:d}=Z(),g=r.useRef(null),w=x=>{x.preventDefault(),x.stopPropagation();const h=o.charAt(0).toUpperCase()+o.slice(1);if(a==="")L.error(`${h} name cannot be empty`);else if(a.length>25)L.error(`${h} name cannot be longer than 25 characters`);else if(a===s)L.error(`${h} name cannot be the same as before`);else{const v=o==="directory"?d(t,a):l(t,a);v&&o==="file"&&c(t),v?n(!1):L.error(`${h} with same name already exists`)}},u=r.useCallback(x=>{var h;x.key==="Enter"?(h=g.current)==null||h.requestSubmit():x.key==="Escape"&&n(!1)},[n]),p=r.useCallback(x=>{const h=g.current;h&&!h.contains(x.target)&&n(!1)},[n]);return r.useEffect(()=>{const x=g.current;if(x)return x.focus(),x.addEventListener("keydown",u),document.addEventListener("keydown",p),document.addEventListener("click",p),()=>{x.removeEventListener("keydown",u),document.removeEventListener("keydown",p),document.removeEventListener("click",p)}},[p,u,n]),e.jsx("div",{className:"rounded-md",children:e.jsx("form",{onSubmit:w,ref:g,className:"flex w-full items-center gap-2 rounded-md",children:e.jsx("input",{type:"text",className:"w-full flex-grow rounded-sm bg-dark px-2 text-base text-white outline-none",autoFocus:!0,value:a,onChange:x=>i(x.target.value)})})})}function an(){const{fileStructure:t,createFile:s,createDirectory:n,collapseDirectories:o}=Z(),a=r.useRef(null),[i,l]=r.useState(null),{minHeightReached:c}=Y(),d=p=>{a.current&&!a.current.contains(p.target)&&l(t.id)},g=()=>{const p=prompt("Enter file name");if(p){const x=i||t.id;s(x,p)}},w=()=>{const p=prompt("Enter directory name");if(p){const x=i||t.id;n(x,p)}},u=qe(t);return e.jsxs("div",{onClick:d,className:"flex flex-grow flex-col",children:[e.jsxs("div",{className:"view-title flex justify-between",children:[e.jsx("h2",{children:"Files"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"rounded-md px-1 hover:bg-darkHover",onClick:g,title:"Create File",children:e.jsx(ft,{size:20})}),e.jsx("button",{className:"rounded-md px-1 hover:bg-darkHover",onClick:w,title:"Create Directory",children:e.jsx(pt,{size:20})}),e.jsx("button",{className:"rounded-md px-1 hover:bg-darkHover",onClick:o,title:"Collapse All Directories",children:e.jsx(ht,{size:20})})]})]}),e.jsx("div",{className:ae("min-h-[200px] flex-grow overflow-auto pr-2 sm:min-h-0",{"h-[calc(80vh-170px)]":!c,"h-[85vh]":c}),ref:a,children:u.children&&u.children.map(p=>e.jsx(et,{item:p,setSelectedDirId:l},p.id))})]})}function et({item:t,setSelectedDirId:s}){const[n,o]=r.useState(!1),a=r.useRef(null),{coords:i,menuOpen:l,setMenuOpen:c}=Ke({ref:a}),{deleteDirectory:d,toggleDirectory:g}=Z(),w=x=>{s(x),g(x)},u=x=>{x.stopPropagation(),c(!1),o(!0)},p=(x,h)=>{x.stopPropagation(),c(!1),confirm("Are you sure you want to delete directory?")&&d(h)};return r.useEffect(()=>{const x=a.current;if(!x)return;x.tabIndex=0;const h=v=>{v.stopPropagation(),v.key==="F2"&&o(!0)};return x.addEventListener("keydown",h),()=>{x.removeEventListener("keydown",h)}},[]),t.type==="file"?e.jsx(ln,{item:t,setSelectedDirId:s}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"flex w-full items-center rounded-md px-2 py-1 hover:bg-darkHover",onClick:()=>w(t.id),ref:a,children:[t.isOpen?e.jsx(xt,{size:24,className:"mr-2 min-w-fit"}):e.jsx(gt,{size:24,className:"mr-2 min-w-fit"}),n?e.jsx(Ze,{id:t.id,preName:t.name,type:"directory",setEditing:o}):e.jsx("p",{className:"flex-grow cursor-pointer overflow-hidden truncate",title:t.name,children:t.name})]}),e.jsx("div",{className:ae({hidden:!t.isOpen},{block:t.isOpen},{"pl-4":t.name!=="root"}),children:t.children&&t.children.map(x=>e.jsx(et,{item:x,setSelectedDirId:s},x.id))}),l&&e.jsx(dn,{handleDeleteDirectory:p,handleRenameDirectory:u,id:t.id,left:i.x,top:i.y})]})}const ln=({item:t,setSelectedDirId:s})=>{const{deleteFile:n,openFile:o}=Z(),[a,i]=r.useState(!1),{setIsSidebarOpen:l}=be(),{isMobile:c}=re(),{activityState:d,setActivityState:g}=J(),w=r.useRef(null),{menuOpen:u,coords:p,setMenuOpen:x}=Ke({ref:w}),h=E=>{a||(s(E),o(E),c&&l(!1),d===X.DRAWING&&g(X.CODING))},v=E=>{E.stopPropagation(),i(!0),x(!1)},S=(E,P)=>{E.stopPropagation(),x(!1),confirm("Are you sure you want to delete file?")&&n(P)};return r.useEffect(()=>{const E=w.current;if(!E)return;E.tabIndex=0;const P=A=>{A.stopPropagation(),A.key==="F2"&&i(!0)};return E.addEventListener("keydown",P),()=>{E.removeEventListener("keydown",P)}},[]),e.jsxs("div",{className:"flex w-full items-center rounded-md px-2 py-1 hover:bg-darkHover",onClick:()=>h(t.id),ref:w,children:[e.jsx(Ue,{icon:Xe(t.name),fontSize:22,className:"mr-2 min-w-fit"}),a?e.jsx(Ze,{id:t.id,preName:t.name,type:"file",setEditing:i}):e.jsx("p",{className:"flex-grow cursor-pointer overflow-hidden truncate",title:t.name,children:t.name}),u&&e.jsx(cn,{top:p.y,left:p.x,id:t.id,handleRenameFile:v,handleDeleteFile:S})]})},cn=({top:t,left:s,id:n,handleRenameFile:o,handleDeleteFile:a})=>e.jsxs("div",{className:"absolute z-10 w-[150px] rounded-md border border-darkHover bg-dark p-1",style:{top:t,left:s},children:[e.jsxs("button",{onClick:o,className:"flex w-full items-center gap-2 rounded-md px-2 py-1 hover:bg-darkHover",children:[e.jsx(_e,{size:18}),"Rename"]}),e.jsxs("button",{onClick:i=>a(i,n),className:"flex w-full items-center gap-2 rounded-md px-2 py-1 text-danger hover:bg-darkHover",children:[e.jsx(Pe,{size:20}),"Delete"]})]}),dn=({top:t,left:s,id:n,handleRenameDirectory:o,handleDeleteDirectory:a})=>e.jsxs("div",{className:"absolute z-10 w-[150px] rounded-md border border-darkHover bg-dark p-1",style:{top:t,left:s},children:[e.jsxs("button",{onClick:o,className:"flex w-full items-center gap-2 rounded-md px-2 py-1 hover:bg-darkHover",children:[e.jsx(_e,{size:18}),"Rename"]}),e.jsxs("button",{onClick:i=>a(i,n),className:"flex w-full items-center gap-2 rounded-md px-2 py-1 text-danger hover:bg-darkHover",children:[e.jsx(Pe,{size:20}),"Delete"]})]});function un(){const{downloadFilesAndFolders:t,updateDirectory:s}=Z(),{viewHeight:n}=Y(),{minHeightReached:o}=Y(),[a,i]=r.useState(!1),l=async()=>{try{if(i(!0),"showDirectoryPicker"in window){const u=await window.showDirectoryPicker();await c(u);return}if("webkitdirectory"in HTMLInputElement.prototype){const u=document.createElement("input");u.type="file",u.webkitdirectory=!0,u.onchange=async p=>{const x=p.target.files;if(x){const h=await g(x);s("",h)}},u.click();return}I.error("Your browser does not support directory selection.")}catch(u){console.error("Error opening directory:",u),I.error("Failed to open directory")}finally{i(!1)}},c=async u=>{try{I.loading("Getting files and folders...");const p=await d(u);s("",p),I.dismiss(),I.success("Directory loaded successfully")}catch(p){console.error("Error processing directory:",p),I.error("Failed to process directory")}},d=async u=>{const p=[],x=["node_modules",".git",".vscode",".next"];for await(const h of u.values())if(h.kind==="file"){const v=await h.getFile(),S={id:V(),name:h.name,type:"file",content:await w(v)};p.push(S)}else if(h.kind==="directory"){if(x.includes(h.name))continue;const v={id:V(),name:h.name,type:"directory",children:await d(h),isOpen:!1};p.push(v)}return p},g=async u=>{const p=[],x=["node_modules",".git",".vscode",".next"];for(let h=0;h<u.length;h++){const v=u[h],S=v.webkitRelativePath.split("/");if(!S.some(E=>x.includes(E)))if(S.length>1){const E=S.slice(0,-1).join("/");if(p.findIndex(_=>_.name===E&&_.type==="directory")===-1){const _={id:V(),name:E,type:"directory",children:[],isOpen:!1};p.push(_)}const A={id:V(),name:v.name,type:"file",content:await w(v)},G=p.find(_=>_.name===E&&_.type==="directory");G&&G.children&&G.children.push(A)}else{const E={id:V(),name:v.name,type:"file",content:await w(v)};p.push(E)}}return p},w=async u=>{if(u.size>1048576)return`File too large: ${u.name} (${Math.round(u.size/1024)}KB)`;try{return await u.text()}catch(x){return console.error(`Error reading file ${u.name}:`,x),`Error reading file: ${u.name}`}};return e.jsxs("div",{className:"flex select-none flex-col gap-1 px-4 py-2",style:{height:n,maxHeight:n},children:[e.jsx(an,{}),e.jsxs("div",{className:ae("flex min-h-fit flex-col justify-end pt-2",{hidden:o}),children:[e.jsx("hr",{}),e.jsxs("button",{className:"mt-2 flex w-full justify-start rounded-md p-2 transition-all hover:bg-darkHover",onClick:l,disabled:a,children:[e.jsx(wt,{className:"mr-2",size:24}),a?"Loading...":"Open File/Folder"]}),e.jsxs("button",{className:"flex w-full justify-start rounded-md p-2 transition-all hover:bg-darkHover",onClick:t,children:[e.jsx(bt,{className:"mr-2",size:22})," Download Code"]})]})]})}const mn="https://emkc.org/api/v2/piston",ye=Se.create({baseURL:mn,headers:{"Content-Type":"application/json"}}),fn="https://cloud.code-editor.ru/api",pn=Se.create({baseURL:fn,headers:{"Content-Type":"application/json"},withCredentials:!0,timeout:3e4}),tt=r.createContext(null),hn=()=>{const t=r.useContext(tt);if(t===null)throw new Error("useRunCode must be used within a RunCodeContextProvider");return t},xn=({children:t})=>{const{activeFile:s}=Z(),[n,o]=r.useState(""),[a,i]=r.useState(""),[l,c]=r.useState(!1),[d,g]=r.useState([]),[w,u]=r.useState({language:"",version:"",aliases:[]});r.useEffect(()=>{(async()=>{var h,v;try{const S=await ye.get("/runtimes");g(S.data)}catch(S){L.error("Failed to fetch supported languages"),(h=S==null?void 0:S.response)!=null&&h.data&&console.error((v=S==null?void 0:S.response)==null?void 0:v.data)}})()},[]),r.useEffect(()=>{if(d.length===0||!(s!=null&&s.name))return;const x=s.name.split(".").pop();if(x){const h=He.languages(x),v=d.find(S=>S.aliases.includes(x)||h.includes(S.language.toLowerCase()));v&&u(v)}else u({language:"",version:"",aliases:[]})},[s==null?void 0:s.name,d]);const p=async()=>{var x;try{if(w)if(s)L.loading("Running code...");else return L.error("Please open a file to run the code");else return L.error("Please select a language to run the code");if(c(!0),w.language==="python"||w.aliases.includes("py"))try{console.log("Trying code-editor-cloud for Python execution");const h=await pn.post("/execute.php",{code:s.content,language:"python",input:n});h.data.success?(i(h.data.output),console.log("Successfully executed using code-editor-cloud")):(i(h.data.error||"Execution failed"),console.log("code-editor-cloud returned error"))}catch(h){console.warn("code-editor-cloud failed, falling back to piston API:",h.message);const{language:v,version:S}=w,E=await ye.post("/execute",{language:v,version:S,files:[{name:s.name,content:s.content}],stdin:n});E.data.run.stderr?i(E.data.run.stderr):i(E.data.run.stdout)}else{const{language:h,version:v}=w,S=await ye.post("/execute",{language:h,version:v,files:[{name:s.name,content:s.content}],stdin:n});S.data.run.stderr?i(S.data.run.stderr):i(S.data.run.stdout)}c(!1),L.dismiss(),L.success("Code executed successfully")}catch(h){console.error("Execution error:",((x=h.response)==null?void 0:x.data)||h.message),c(!1),L.dismiss(),L.error("Failed to run the code")}};return e.jsx(tt.Provider,{value:{setInput:o,output:a,isRunning:l,supportedLanguages:d,selectedLanguage:w,setSelectedLanguage:u,runCode:p},children:t})};function gn(){const{viewHeight:t}=Y(),{setInput:s,output:n,isRunning:o,supportedLanguages:a,selectedLanguage:i,setSelectedLanguage:l,runCode:c}=hn(),d=w=>{const u=JSON.parse(w.target.value);l(u)},g=()=>{navigator.clipboard.writeText(n),L.success("Output copied to clipboard")};return e.jsxs("div",{className:"flex flex-col items-center gap-2 p-4",style:{height:t},children:[e.jsx("h1",{className:"view-title",children:"Run Code"}),e.jsxs("div",{className:"flex h-[90%] w-full flex-col items-end gap-2 md:h-[92%]",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("select",{className:"w-full rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",value:JSON.stringify(i),onChange:d,children:a.sort((w,u)=>w.language>u.language?1:-1).map((w,u)=>e.jsx("option",{value:JSON.stringify(w),children:w.language+(w.version?` (${w.version})`:"")},u))}),e.jsx(Me,{size:16,className:"absolute bottom-3 right-4 z-10 text-white"})]}),e.jsx("textarea",{className:"min-h-[120px] w-full resize-none rounded-md border-none bg-darkHover p-2 text-white outline-none",placeholder:"Write you input here...",onChange:w=>s(w.target.value)}),e.jsx("button",{className:"flex w-full justify-center rounded-md bg-primary p-2 font-bold text-black outline-none disabled:cursor-not-allowed disabled:opacity-50",onClick:c,disabled:o,children:"Run"}),e.jsxs("label",{className:"flex w-full justify-between",children:["Output :",e.jsx("button",{onClick:g,title:"Copy Output",children:e.jsx(je,{size:18,className:"cursor-pointer text-white"})})]}),e.jsx("div",{className:"w-full flex-grow resize-none overflow-y-auto rounded-md border-none bg-darkHover p-2 text-white outline-none",children:e.jsx("code",{children:e.jsx("pre",{className:"text-wrap",children:n})})})]})]})}function Ee({onChange:t,value:s,options:n,title:o}){return e.jsxs("div",{className:"relative w-full",children:[e.jsx("label",{className:"mb-2",children:o}),e.jsx("select",{className:"w-full rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",value:s,onChange:t,children:n.sort().map(a=>{const i=a,l=a.charAt(0).toUpperCase()+a.slice(1);return e.jsx("option",{value:i,children:l},l)})}),e.jsx(Me,{size:16,className:"absolute bottom-3 right-4 z-10 text-white"})]})}const wn=["Anonymous Pro","Cousine","Fira Code","Inconsolata","JetBrains Mono","Jura","Roboto Mono","Source Code Pro","Space Mono","Ubuntu Mono"],st={Abcdef:js,Abyss:vs,"Android Studio":Ns,Andromeda:Es,"Atom One":ys,Aura:Cs,"Basic Dark":bs,"Basic Light":ws,BBEdit:gs,Bespin:xs,Copilot:hs,Darcula:ps,Dracula:fs,"Duotone Dark":ms,"Duotone Light":us,Eclipse:ds,"GitHub Dark":cs,"GitHub Light":ls,"Gruvbox Dark":as,"Gruvbox Light":is,Kimbie:rs,Material:os,"Material Dark":ns,"Material Light":ss,Monokai:ts,"Monokai Dimmed":es,"Noctis Lilac":Zt,Nord:Xt,Okaidia:Kt,"Quiet Light":Qt,Red:qt,"Solarized Dark":Bt,"Solarized Light":Vt,Sublime:Yt,"Tokyo Night":$t,"Tokyo Night Day":Jt,"Tokyo Night Storm":Wt,"Tomorrow Night Blue":Gt,"VS Code Dark":zt,"White Dark":Ht,"White Light":Ut,"Xcode Dark":Mt,"Xcode Light":Pt};function bn(){const{theme:t,setTheme:s,language:n,setLanguage:o,fontSize:a,setFontSize:i,fontFamily:l,setFontFamily:c,showGitHubCorner:d,setShowGitHubCorner:g,resetSettings:w}=pe(),{viewHeight:u}=Y(),p=E=>c(E.target.value),x=E=>s(E.target.value),h=E=>o(E.target.value),v=E=>i(parseInt(E.target.value)),S=E=>g(E.target.checked);return r.useEffect(()=>{const E=document.querySelector(".cm-editor > .cm-scroller");E!==null&&(E.style.fontFamily=`${l}, monospace`)},[l]),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-4",style:{height:u},children:[e.jsx("h1",{className:"view-title",children:"Settings"}),e.jsxs("div",{className:"flex w-full items-end gap-2",children:[e.jsx(Ee,{onChange:p,value:l,options:wn,title:"Font Family"}),e.jsx("select",{value:a,onChange:v,className:"rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",title:"Font Size",children:[...Array(13).keys()].map(E=>e.jsx("option",{value:E+12,children:E+12},E))})]}),e.jsx(Ee,{onChange:x,value:t,options:Object.keys(st),title:"Theme"}),e.jsx(Ee,{onChange:h,value:n,options:Ss,title:"Language"}),e.jsxs("div",{className:"mt-4 flex w-full items-center justify-between",children:[e.jsx("label",{children:"Show github corner"}),e.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[e.jsx("input",{className:"peer sr-only",type:"checkbox",onChange:S,checked:d}),e.jsx("div",{className:"peer h-6 w-12 rounded-full bg-darkHover outline-none duration-100 after:absolute after:left-1 after:top-1 after:flex after:h-4 after:w-4 after:items-center after:justify-center after:rounded-full after:bg-white after:font-bold after:outline-none after:duration-500 peer-checked:after:translate-x-6 peer-checked:after:border-white peer-focus:outline-none"})]})]}),e.jsx("button",{className:"mt-auto w-full rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",onClick:w,children:"Reset to default"})]})}function Cn(){const{users:t}=J();return e.jsx("div",{className:"flex min-h-[200px] flex-grow justify-center overflow-y-auto py-2",children:e.jsx("div",{className:"flex h-full w-full flex-wrap items-start gap-x-2 gap-y-6",children:t.map(s=>e.jsx(yn,{user:s},s.socketId))})})}const yn=({user:t})=>{const{username:s,status:n}=t,o=`${s} - ${n===fe.ONLINE?"online":"offline"}`;return e.jsxs("div",{className:"relative flex w-[100px] flex-col items-center gap-2",title:o,children:[e.jsx(Os,{name:s,size:"50",round:"12px",title:o}),e.jsx("p",{className:"line-clamp-2 max-w-full text-ellipsis break-words",children:s}),e.jsx("div",{className:`absolute right-5 top-0 h-3 w-3 rounded-full ${n===fe.ONLINE?"bg-green-500":"bg-danger"}`})]})};function En(){const t=we(),{viewHeight:s}=Y(),{setStatus:n}=J(),{socket:o}=B(),a=async()=>{const c=window.location.href;try{await navigator.clipboard.writeText(c),L.success("URL copied to clipboard")}catch(d){L.error("Unable to copy URL to clipboard"),console.log(d)}},i=async()=>{const c=window.location.href;try{await navigator.share({url:c})}catch(d){L.error("Unable to share URL"),console.log(d)}},l=()=>{o.disconnect(),n(U.DISCONNECTED),t("/",{replace:!0})};return e.jsxs("div",{className:"flex flex-col p-4",style:{height:s},children:[e.jsx("h1",{className:"view-title",children:"Users"}),e.jsx(Cn,{}),e.jsx("div",{className:"flex flex-col items-center gap-4 pt-4",children:e.jsxs("div",{className:"flex w-full gap-4",children:[e.jsx("button",{className:"flex flex-grow items-center justify-center rounded-md bg-white p-3 text-black",onClick:i,title:"Share Link",children:e.jsx(Ct,{size:26})}),e.jsx("button",{className:"flex flex-grow items-center justify-center rounded-md bg-white p-3 text-black",onClick:a,title:"Copy Link",children:e.jsx(je,{size:22})}),e.jsx("button",{className:"flex flex-grow items-center justify-center rounded-md bg-primary p-3 text-black",onClick:l,title:"Leave room",children:e.jsx(yt,{size:22})})]})})]})}var T=(t=>(t.FILES="FILES",t.CHATS="CHATS",t.CLIENTS="CLIENTS",t.RUN="RUN",t.COPILOT="COPILOT",t.SETTINGS="SETTINGS",t))(T||{});const nt=r.createContext(null),be=()=>{const t=r.useContext(nt);if(!t)throw new Error("useViews must be used within a ViewContextProvider");return t};function Nn({children:t}){const{isMobile:s}=re(),[n,o]=r.useState(T.FILES),[a,i]=r.useState(!s),[l]=r.useState({[T.FILES]:e.jsx(un,{}),[T.CLIENTS]:e.jsx(En,{}),[T.SETTINGS]:e.jsx(bn,{}),[T.COPILOT]:e.jsx(rn,{}),[T.CHATS]:e.jsx(Ks,{}),[T.RUN]:e.jsx(gn,{})}),[c]=r.useState({[T.FILES]:e.jsx(Rt,{size:28}),[T.CLIENTS]:e.jsx(St,{size:30}),[T.SETTINGS]:e.jsx(jt,{size:28}),[T.CHATS]:e.jsx(vt,{size:30}),[T.COPILOT]:e.jsx(Nt,{size:28}),[T.RUN]:e.jsx(Et,{size:28})});return e.jsx(nt.Provider,{value:{activeView:n,setActiveView:o,isSidebarOpen:a,setIsSidebarOpen:i,viewComponents:l,viewIcons:c},children:t})}function vn({children:t}){const{isSidebarOpen:s}=be(),{isMobile:n,width:o}=re(),{setItem:a,getItem:i}=Ge(),l=()=>{const p=document.createElement("div");return p.className="h-full cursor-e-resizer hidden md:block",p.style.backgroundColor="#e1e1ffb3",p},c=()=>{if(n)return[0,o];const p=i("editorSizes");let x=[35,65];return p&&(x=JSON.parse(p)),s?x:[0,o]},d=()=>n?[0,o]:s?[350,350]:[50,0],g=()=>n?[0,1/0]:s?[1/0,1/0]:[0,1/0],w=p=>{a("editorSizes",JSON.stringify(p))},u=()=>({width:"7px",display:s&&!n?"block":"none"});return e.jsx(As,{sizes:c(),minSize:d(),gutter:l,maxSize:g(),dragInterval:1,direction:"horizontal",gutterAlign:"center",cursor:"e-resize",snapOffset:30,gutterStyle:u,onDrag:w,className:"flex h-screen min-h-screen max-w-full items-center justify-center overflow-hidden",children:t})}function jn(){return e.jsx("div",{className:"flex h-screen min-h-screen flex-col items-center justify-center gap-6 px-4 text-center",children:e.jsx(Sn,{})})}const Sn=()=>{const t=we(),s=()=>{window.location.reload()},n=()=>{t("/")};return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"whitespace-break-spaces text-lg font-medium text-slate-300",children:"Oops! Something went wrong. Please try again"}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[e.jsx("button",{className:"mr-4 rounded-md bg-primary px-8 py-2 font-bold text-black",onClick:s,children:"Try Again"}),e.jsx("button",{className:"rounded-md bg-primary px-8 py-2 font-bold text-black",onClick:n,children:"Go to HomePage"})]})]})},ve={backgroundColor:"#e0e0e0",padding:"8px 12px",borderRadius:"6px",color:"#000",fontSize:"12px",fontWeight:"500",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},Le={base:"relative flex items-center justify-center rounded transition-colors duration-200 ease-in-out p-2",hover:"hover:bg-[#3D404A]"},ie=({viewName:t,icon:s})=>{const{activeView:n,setActiveView:o,isSidebarOpen:a,setIsSidebarOpen:i}=be(),{isNewMessage:l}=Ie(),[c,d]=r.useState(!0),g=w=>{w===n?i(!a):(i(!0),o(w))};return e.jsxs("div",{className:"relative flex flex-col items-center",children:[e.jsxs("button",{onClick:()=>g(t),onMouseEnter:()=>d(!0),className:`${Le.base} ${Le.hover}`,...c&&{"data-tooltip-id":`tooltip-${t}`,"data-tooltip-content":t},children:[e.jsx("div",{className:"flex items-center justify-center",children:s}),t===T.CHATS&&l&&e.jsx("div",{className:"absolute right-0 top-0 h-3 w-3 rounded-full bg-primary"})]}),c&&e.jsx(Ne,{id:`tooltip-${t}`,place:"right",offset:25,className:"!z-50",style:ve,noArrow:!1,positionStrategy:"fixed",float:!0})]})};function Rn(){const{activeView:t,isSidebarOpen:s,viewComponents:n,viewIcons:o,setIsSidebarOpen:a}=be(),{minHeightReached:i}=Y(),{activityState:l,setActivityState:c}=J(),{socket:d}=B(),{isMobile:g}=re(),[w,u]=r.useState(!0),[p,x]=r.useState(!1),[h,v]=r.useState(""),[S,E]=r.useState(""),[P,A]=r.useState(!1),G=()=>{u(!1),l===X.CODING?(c(X.DRAWING),d.emit(f.REQUEST_DRAWING)):c(X.CODING),g&&a(!1)},_=async()=>{if(h.trim()){A(!0),E(R=>R+`
$ ${h}
`);try{const D=await(await fetch("https://cloud.code-editor.ru/api/terminal.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:h})})).json();D.success?E(H=>H+D.output+`
`):E(H=>H+`Error: ${D.error}
`)}catch(R){E(D=>D+`Network Error: ${R}
`)}finally{A(!1),v("")}}},W=R=>{R.key==="Enter"&&!R.shiftKey&&(R.preventDefault(),_())},ne=()=>{E("")},$=R=>{v(`pip install ${R}`)};return e.jsxs(e.Fragment,{children:[e.jsxs("aside",{className:"flex w-full md:h-full md:max-h-full md:min-h-full md:w-auto",children:[e.jsxs("div",{className:ae("fixed bottom-0 left-0 z-50 flex h-[50px] w-full gap-4 self-end overflow-hidden border-t border-darkHover bg-dark p-2 md:static md:h-full md:w-[50px] md:min-w-[50px] md:flex-col md:border-r md:border-t-0 md:p-2 md:pt-4",{hidden:i}),children:[e.jsx(ie,{viewName:T.FILES,icon:o[T.FILES]}),e.jsx(ie,{viewName:T.CHATS,icon:o[T.CHATS]}),e.jsx(ie,{viewName:T.COPILOT,icon:o[T.COPILOT]}),e.jsx(ie,{viewName:T.RUN,icon:o[T.RUN]}),e.jsx(ie,{viewName:T.CLIENTS,icon:o[T.CLIENTS]}),e.jsx(ie,{viewName:T.SETTINGS,icon:o[T.SETTINGS]}),e.jsxs("div",{className:"flex h-fit items-center justify-center",children:[e.jsx("button",{className:"flex items-center justify-center rounded p-1.5 transition-colors duration-200 ease-in-out hover:bg-[#3D404A]",onClick:()=>x(!0),onMouseEnter:()=>u(!0),"data-tooltip-id":"terminal-tooltip","data-tooltip-content":"Open Terminal",children:e.jsx(De,{size:24,className:"text-green-400"})}),w&&e.jsx(Ne,{id:"terminal-tooltip",place:"right",offset:15,className:"!z-50",style:ve,noArrow:!1,positionStrategy:"fixed",float:!0})]}),e.jsxs("div",{className:"flex h-fit items-center justify-center",children:[e.jsx("button",{className:"flex items-center justify-center rounded p-1.5 transition-colors duration-200 ease-in-out hover:bg-[#3D404A]",onClick:G,onMouseEnter:()=>u(!0),"data-tooltip-id":"activity-state-tooltip","data-tooltip-content":l===X.CODING?"Switch to Drawing Mode":"Switch to Coding Mode",children:l===X.CODING?e.jsx(It,{size:30}):e.jsx(Dt,{size:30})}),w&&e.jsx(Ne,{id:"activity-state-tooltip",place:"right",offset:15,className:"!z-50",style:ve,noArrow:!1,positionStrategy:"fixed",float:!0})]})]}),e.jsx("div",{className:"absolute left-0 top-0 z-20 w-full flex-col bg-dark md:static md:min-w-[300px]",style:s?{}:{display:"none"},children:n[t]})]}),p&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm",children:e.jsxs("div",{className:"flex h-[600px] w-[800px] flex-col overflow-hidden rounded-lg border border-gray-700 bg-[#0C0C0C] shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between bg-[#2D2D2D] px-4 py-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(De,{className:"text-green-400",size:16}),e.jsx("span",{className:"text-sm font-medium text-white",children:"Command Prompt"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{className:"flex h-6 w-6 items-center justify-center rounded hover:bg-[#3D3D3D]",onClick:ne,children:e.jsx("span",{className:"text-xs text-white",children:"ðŸ—‘ï¸"})}),e.jsx("button",{className:"flex h-6 w-6 items-center justify-center rounded hover:bg-[#3D3D3D]",onClick:()=>x(!1),children:e.jsx("span",{className:"text-xs text-white",children:"âœ•"})})]})]}),e.jsxs("div",{className:"flex space-x-2 bg-[#1E1E1E] px-4 py-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Quick install:"}),e.jsx("button",{onClick:()=>$("numpy"),className:"rounded bg-blue-600 px-2 py-1 text-xs text-white hover:bg-blue-700",children:"numpy"}),e.jsx("button",{onClick:()=>$("pandas"),className:"rounded bg-blue-600 px-2 py-1 text-xs text-white hover:bg-blue-700",children:"pandas"}),e.jsx("button",{onClick:()=>$("matplotlib"),className:"rounded bg-blue-600 px-2 py-1 text-xs text-white hover:bg-blue-700",children:"matplotlib"}),e.jsx("button",{onClick:()=>$("requests"),className:"rounded bg-blue-600 px-2 py-1 text-xs text-white hover:bg-blue-700",children:"requests"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#0C0C0C] p-4 font-mono text-sm",children:[e.jsxs("div",{className:"text-green-400",children:["Windows Terminal [Version 1.0.0]",e.jsx("br",{}),"(c) Code Editor Cloud. All rights reserved.",e.jsx("br",{}),e.jsx("br",{}),"Type 'pip list' to see installed packages",e.jsx("br",{}),"Type 'venv-info' for virtual environment info",e.jsx("br",{}),e.jsx("br",{})]}),e.jsx("pre",{className:"whitespace-pre-wrap break-words text-gray-200",children:S||`Welcome to Code Editor Cloud Terminal
`}),P&&e.jsxs("div",{className:"flex items-center space-x-2 text-yellow-400",children:[e.jsx("div",{className:"h-2 w-2 animate-ping rounded-full bg-yellow-400"}),e.jsx("span",{children:"Executing command..."})]})]}),e.jsxs("div",{className:"border-t border-gray-700 bg-[#0C0C0C] p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-green-400",children:"$"}),e.jsx("input",{type:"text",value:h,onChange:R=>v(R.target.value),onKeyPress:W,placeholder:"Enter command...",className:"flex-1 bg-transparent font-mono text-sm text-white outline-none placeholder:text-gray-500",disabled:P,autoFocus:!0}),e.jsx("button",{onClick:_,disabled:P||!h.trim(),className:"rounded bg-green-600 px-3 py-1 text-xs text-white hover:bg-green-700 disabled:bg-gray-600 disabled:text-gray-400",children:P?"Running...":"Run"})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:"Available commands: pip install, pip list, python --version, venv-info, check <package>"})]})]})})]})}function In(){const{isMobile:t}=re();return e.jsx(_s,{inferDarkMode:!0,forceMobile:t,defaultName:"Editor",className:"z-0",children:e.jsx(Dn,{})})}function Dn(){const t=Fs(),{drawingData:s,setDrawingData:n}=J(),{socket:o}=B(),a=r.useCallback(l=>{const c=l.changes;n(t.store.getSnapshot()),o.emit(f.DRAWING_UPDATE,{snapshot:c})},[t.store,n,o]),i=r.useCallback(({snapshot:l})=>{t.store.mergeRemoteChanges(()=>{const{added:c,updated:d,removed:g}=l;for(const w of Object.values(c))t.store.put([w]);for(const[,w]of Object.values(d))t.store.put([w]);for(const w of Object.values(g))t.store.remove([w.id])}),n(t.store.getSnapshot())},[t.store,n]);return r.useEffect(()=>{s&&Object.keys(s).length>0&&t.store.loadSnapshot(s)},[]),r.useEffect(()=>{const l=t.store.listen(a,{source:"user",scope:"document"});return o.on(f.DRAWING_UPDATE,i),()=>{l(),o.off(f.DRAWING_UPDATE)}},[s,t.store,a,i,o]),null}function kn(){const{fontSize:t,setFontSize:s}=pe();r.useEffect(()=>{const n=o=>{const a="Changes you made may not be saved";return o.returnValue=a};return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}},[]),r.useEffect(()=>{const n=o=>{if(o.ctrlKey){if(o.preventDefault(),!o.target.closest(".cm-editor"))return;o.deltaY>0?s(Math.max(t-1,12)):s(Math.min(t+1,24))}};return window.addEventListener("wheel",n,{passive:!1}),()=>{window.removeEventListener("wheel",n)}},[t,s])}const ot=Ps.define();function rt(t){const s=["#FF0000","#008080","#0000FF","#008000","#FFD700","#800080","#00CED1","#FFA500","#9932CC","#1E90FF"];let n=0;for(let o=0;o<t.length;o++)n=t.charCodeAt(o)+((n<<5)-n);return s[Math.abs(n)%s.length]}class On extends Us{constructor(s){super(),this.user=s}eq(s){return this.user.username===s.user.username&&this.user.typing===s.user.typing}toDOM(){const s=rt(this.user.username),n=document.createElement("span");n.className="cm-remote-cursor",n.style.cssText=`
            position: absolute;
            width: 2px;
            height: 1.2em;
            background-color: ${s};
            border-radius: 1px;
            pointer-events: none;
            z-index: 10;
            animation: cursor-blink 1s infinite;
        `;const o=document.createElement("span");return o.className="cm-remote-cursor-label",o.textContent=this.user.username,o.style.cssText=`
            position: absolute;
            top: -20px;
            left: 0;
            background-color: ${s};
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
            pointer-events: none;
            z-index: 11;
            opacity: ${this.user.typing?"1":"0.7"};
            transition: opacity 0.3s ease;
        `,n.appendChild(o),n}}function Tn(t,s){return xe.widget({widget:new On(t),side:1}).range(s)}function Ln(t,s,n){const o=rt(t.username);return xe.mark({class:"cm-remote-selection",attributes:{style:`
                background-color: ${o}33;
                border-left: 2px solid ${o};
                border-radius: 2px;
            `}}).range(s,n)}const An=Ms.define({create(){return xe.none},update(t,s){t=t.map(s.changes);for(const n of s.effects)if(n.is(ot)){const o=n.value,a=[];for(const i of o)if(!(!i.typing&&!i.selectionStart&&!i.selectionEnd)){if(i.selectionStart!==void 0&&i.selectionEnd!==void 0&&i.selectionStart!==i.selectionEnd){const l=Math.min(i.selectionStart,s.newDoc.length),c=Math.min(i.selectionEnd,s.newDoc.length);l<c&&a.push(Ln(i,l,c))}if(i.cursorPosition>=0){const l=Math.min(i.cursorPosition,s.newDoc.length);a.push(Tn(i,l))}}return a.sort((i,l)=>{var w,u,p,x;const c=i.from-l.from;if(c!==0)return c;const d=((u=(w=i.value)==null?void 0:w.spec)==null?void 0:u.startSide)||0,g=((x=(p=l.value)==null?void 0:p.spec)==null?void 0:x.startSide)||0;return d-g}),xe.set(a,!0)}return t},provide:t=>Re.decorations.from(t)}),Fn=Re.baseTheme({".cm-remote-cursor":{position:"relative",display:"inline-block"},".cm-remote-selection":{position:"relative"},"@keyframes cursor-blink":{"0%, 50%":{opacity:"1"},"51%, 100%":{opacity:"0"}}});function _n(){return[An,Fn]}const ge={php:"php",phtml:"php",php3:"php",php4:"php",php5:"php",php7:"php",phps:"php",cs:"csharp",csx:"csharp",js:"javascript",jsx:"javascript",mjs:"javascript",cjs:"javascript",ts:"typescript",tsx:"typescript",mts:"typescript",cts:"typescript",java:"java",jsp:"java",py:"python",pyw:"python",pyi:"python",pyx:"python",c:"c",h:"c",cpp:"cpp",cxx:"cpp",cc:"cpp",hpp:"cpp",hxx:"cpp",hh:"cpp",html:"html",htm:"html",xhtml:"html",css:"css",scss:"scss",sass:"sass",less:"less",md:"markdown",markdown:"markdown",mdx:"markdown",json:"json",xml:"xml",xsd:"xml",xsl:"xml",xslt:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"shell",bash:"shell",zsh:"shell",fish:"shell",ps1:"powershell",psm1:"powershell",psd1:"powershell",rb:"ruby",rbx:"ruby",rjs:"ruby",rake:"ruby",go:"go",rs:"rust",swift:"swift",kt:"kotlin",kts:"kotlin",scala:"scala",sc:"scala",dart:"dart",lua:"lua",pl:"perl",pm:"perl",t:"perl",r:"r",R:"r",m:"objectivec",mm:"objectivec",vue:"vue",svelte:"svelte",component:"typescript",env:"shell",gitignore:"shell",dockerignore:"shell",editorconfig:"shell",dockerfile:"dockerfile",mk:"makefile",make:"makefile",makefile:"makefile",txt:"text",text:"text",csv:"csv",tsv:"tsv",log:"text",ini:"ini",cfg:"ini",conf:"ini",toml:"toml",graphql:"graphql",gql:"graphql",prisma:"prisma",proto:"protobuf",tex:"latex",sty:"latex",cls:"latex",bib:"bibtex",matlab:"matlab",ino:"arduino",asm:"assembly",s:"assembly",S:"assembly",f:"fortran",for:"fortran",f90:"fortran",f95:"fortran",hs:"haskell",lhs:"haskell",ex:"elixir",exs:"elixir",erl:"erlang",hrl:"erlang",clj:"clojure",cljs:"clojure",cljc:"clojure",groovy:"groovy",gvy:"groovy",gy:"groovy",gsh:"groovy",jl:"julia",pas:"pascal",p:"pascal",pro:"prolog",vhd:"vhdl",vhdl:"vhdl",v:"verilog",sv:"verilog",cob:"cobol",cbl:"cobol"};function Pn(){const{users:t,currentUser:s}=J(),{activeFile:n,setActiveFile:o}=Z(),{theme:a,language:i,fontSize:l}=pe(),{socket:c}=B(),{viewHeight:d}=Y(),[g,w]=r.useState(setTimeout(()=>{},0)),u=r.useMemo(()=>t.filter(R=>R.username!==s.username),[t,s]),[p,x]=r.useState([]),h=r.useRef(null),[v,S]=r.useState(0),[E,P]=r.useState({}),A=r.useRef(null),G=r.useCallback(R=>{if(!R)return null;const D=R.toLowerCase().slice(R.lastIndexOf(".")+1);return ge[D]||null},[]),_=r.useCallback(R=>{if(!R)return null;const D=R.toLowerCase().trim();return ge[D]||null},[]),W=r.useMemo(()=>{if(n!=null&&n.name){const R=G(n.name);if(R)return R}if(i){const R=_(i);if(R)return R}return null},[n==null?void 0:n.name,i,G,_]),ne=(R,D)=>{var Q,oe;if(!n)return;const H={...n,content:R};o(H);const F=(oe=(Q=D.state)==null?void 0:Q.selection)==null?void 0:oe.main,q=(F==null?void 0:F.head)||0,te=F==null?void 0:F.from,se=F==null?void 0:F.to;c.emit(f.TYPING_START,{cursorPosition:q,selectionStart:te,selectionEnd:se}),c.emit(f.FILE_UPDATED,{fileId:n.id,newContent:R}),clearTimeout(g);const ee=setTimeout(()=>c.emit(f.TYPING_PAUSE),1e3);w(ee)},$=r.useCallback(R=>{var ee,Q;if(!R.selectionSet)return;const D=(Q=(ee=R.state)==null?void 0:ee.selection)==null?void 0:Q.main,H=(D==null?void 0:D.head)||0,F=D==null?void 0:D.from,q=D==null?void 0:D.to,te=H!==v,se=F!==E.start||q!==E.end;(te||se)&&(S(H),P({start:F,end:q}),A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{c.emit(f.CURSOR_MOVE,{cursorPosition:H,selectionStart:F,selectionEnd:q})},100))},[v,E,c]);return kn(),r.useEffect(()=>{const R=[Rs,Is,_n(),Re.updateListener.of($),Hs()];let D=null;W&&(D=Ds(W)),D?x([...R,D]):(i&&!W&&L.error(`Syntax highlighting is unavailable for "${i}". Using plain text mode.`,{duration:4e3,icon:"âš ï¸"}),x(R))},[W,i,u,$]),r.useEffect(()=>{var R;(R=h.current)!=null&&R.view&&h.current.view.dispatch({effects:ot.of(u)})},[u]),e.jsx(ks,{ref:h,theme:st[a],onChange:ne,value:n==null?void 0:n.content,extensions:p,minHeight:"100%",maxWidth:"100vw",style:{fontSize:l+"px",height:d,position:"relative"}})}function Mn(){const{openFiles:t,closeFile:s,activeFile:n,updateFileContent:o,setActiveFile:a}=Z(),i=r.useRef(null),{setLanguage:l}=pe(),c=d=>{if((n==null?void 0:n.id)===d)return;o((n==null?void 0:n.id)||"",(n==null?void 0:n.content)||"");const g=t.find(w=>w.id===d);g&&a(g)};return r.useEffect(()=>{const d=i.current;if(!d)return;const g=w=>{w.deltaY>0?d.scrollLeft+=100:d.scrollLeft-=100};return d.addEventListener("wheel",g),()=>{d.removeEventListener("wheel",g)}},[]),r.useEffect(()=>{if((n==null?void 0:n.name)===void 0)return;const d=n.name.split(".").pop();if(!d)return;if(ge[d]){l(ge[d]);return}const g=He.languages(d);l(g[0])},[n==null?void 0:n.name,l]),e.jsx("div",{className:"flex h-[50px] w-full select-none gap-2 overflow-x-auto p-2 pb-0",ref:i,children:t.map(d=>e.jsxs("span",{className:ae("flex w-fit cursor-pointer items-center rounded-t-md px-2 py-1 text-white",{"bg-darkHover":d.id===(n==null?void 0:n.id)}),onClick:()=>c(d.id),children:[e.jsx(Ue,{icon:Xe(d.name),fontSize:22,className:"mr-2 min-w-fit"}),e.jsx("p",{className:"flex-grow cursor-pointer overflow-hidden truncate",title:d.name,children:d.name}),e.jsx(kt,{className:"ml-3 inline rounded-md hover:bg-darkHover",size:20,onClick:()=>s(d.id)})]},d.id))})}function Un(){const{openFiles:t}=Z(),{minHeightReached:s}=Y();return t.length<=0?e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx("h1",{className:"text-xl text-white",children:"No file is currently open."})}):e.jsxs("main",{className:ae("flex w-full flex-col overflow-x-auto md:h-screen",{"h-[calc(100vh-50px)]":!s,"h-full":s}),children:[e.jsx(Mn,{}),e.jsx(Pn,{})]})}function Hn(){const{viewHeight:t}=Y(),{activityState:s}=J();return e.jsx("div",{className:"absolute left-0 top-0 w-full max-w-full flex-grow overflow-x-hidden md:static",style:{height:t},children:s===X.DRAWING?e.jsx(In,{}):e.jsx(Un,{})})}function zn(){function t(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(o=>navigator.userAgent.match(o))}const s=t();r.useEffect(()=>{s&&Oe.isEnabled&&Oe.request()},[s])}function Gn(){const{setUsers:t}=J(),{socket:s}=B(),n=r.useCallback(()=>{document.visibilityState==="visible"?s.emit(f.USER_ONLINE,{socketId:s.id}):document.visibilityState==="hidden"&&s.emit(f.USER_OFFLINE,{socketId:s.id})},[s]),o=r.useCallback(({socketId:l})=>{t(c=>c.map(d=>d.socketId===l?{...d,status:fe.ONLINE}:d))},[t]),a=r.useCallback(({socketId:l})=>{t(c=>c.map(d=>d.socketId===l?{...d,status:fe.OFFLINE}:d))},[t]),i=r.useCallback(({user:l})=>{t(c=>c.map(d=>d.socketId===l.socketId?l:d))},[t]);r.useEffect(()=>(document.addEventListener("visibilitychange",n),s.on(f.USER_ONLINE,o),s.on(f.USER_OFFLINE,a),s.on(f.TYPING_START,i),s.on(f.TYPING_PAUSE,i),s.on(f.CURSOR_MOVE,i),()=>{document.removeEventListener("visibilitychange",n),s.off(f.USER_ONLINE),s.off(f.USER_OFFLINE),s.off(f.TYPING_START),s.off(f.TYPING_PAUSE),s.off(f.CURSOR_MOVE)}),[s,t,n,o,a,i])}function Wn(){var c;Gn(),zn();const t=we(),{roomId:s}=Ts(),{status:n,setCurrentUser:o,currentUser:a}=J(),{socket:i}=B(),l=ze();return r.useEffect(()=>{var g;if(a.username.length>0)return;const d=(g=l.state)==null?void 0:g.username;if(d===void 0)t("/",{state:{roomId:s}});else if(s){const w={username:d,roomId:s};o(w),i.emit(f.JOIN_REQUEST,w)}},[a.username,(c=l.state)==null?void 0:c.username,t,s,o,i]),n===U.CONNECTION_FAILED?e.jsx(jn,{}):e.jsxs(vn,{children:[e.jsx(Rn,{}),e.jsx(Hn,{})]})}const Jn="/assets/illustration-Azuc-YCm.svg",$n="/assets/logo-eD4nMjT1.svg",Ae=()=>e.jsxs("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Fe=()=>e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),Yn=()=>{var de,ue;const t=ze(),{currentUser:s,setCurrentUser:n,status:o,setStatus:a}=J(),{socket:i}=B(),[l,c]=r.useState(!1),[d,g]=r.useState(""),[w,u]=r.useState(!1),[p,x]=r.useState(!1),[h,v]=r.useState(null),[S,E]=r.useState(!1),[P,A]=r.useState(""),[G,_]=r.useState(!1),[W,ne]=r.useState(!1),$=r.useRef(null),R=r.useRef(null),D=we();r.useEffect(()=>{const k=localStorage.getItem("savedUsername"),M=localStorage.getItem("savedRoomId");localStorage.getItem("rememberMe")==="true"&&k&&M&&(n({...s,username:k,roomId:M}),u(!0))},[n]);const H=()=>{var M;const k=V();n({...s,roomId:k}),c(!0),v(null),I.success("Created a new Room ID"),(M=$.current)==null||M.focus()},F=k=>{const M=k.target.name,m=k.target.value;n({...s,[M]:m})},q=k=>{g(k.target.value)},te=k=>{u(k.target.checked)},se=()=>{_(!G)},ee=()=>{ne(!W)},Q=()=>s.username.trim().length===0?(I.error("Enter your username"),!1):s.roomId.trim().length===0?(I.error("Enter a room ID"),!1):s.roomId.trim().length<5?(I.error("Room ID must be at least 5 characters long"),!1):s.username.trim().length<3?(I.error("Username must be at least 3 characters long"),!1):!0;r.useEffect(()=>{s.roomId.trim().length>=5?oe():(v(null),c(!1))},[s.roomId]);const oe=async()=>{s.roomId.trim().length<5||(E(!0),i.emit(f.ROOM_INFO_REQUEST,{roomId:s.roomId}))},le=()=>{if(!d.trim()){I.error("Please enter room password");return}A(d),i.emit(f.CHECK_ROOM_PASSWORD,{roomId:s.roomId,password:d})},he=k=>{if(k.preventDefault(),o!==U.ATTEMPTING_JOIN&&Q()){if(w?(localStorage.setItem("savedUsername",s.username),localStorage.setItem("savedRoomId",s.roomId),localStorage.setItem("rememberMe","true")):(localStorage.removeItem("savedUsername"),localStorage.removeItem("savedRoomId"),localStorage.removeItem("rememberMe")),h&&h.has_password&&!l){x(!0);return}ce()}},ce=k=>{I.loading(l?"Creating room...":"Joining room..."),a(U.ATTEMPTING_JOIN);const M=k||P||(l?d:""),m={roomId:s.roomId,username:s.username,password:M,roomName:l?`${s.username}'s Room`:"Collaborative Room"};console.log("Sending JOIN_REQUEST with password:",M?"***":"empty"),i.emit(f.JOIN_REQUEST,m),c(!1)};return r.useEffect(()=>{const k=z=>{E(!1),v(z.roomInfo),c(!1)},M=z=>{x(!1),I.success("Password verified!"),console.log("Verified room:",z.roomId),ce(d)},m=()=>{var z;I.error("Incorrect password"),g(""),A(""),(z=R.current)==null||z.focus()},b=()=>{x(!0)},y=z=>{E(!1),I.dismiss(),z.message==="Room not found"?(v(null),s.roomId.trim().length>=5&&c(!0)):I.error(z.message)},C=z=>{a(U.JOINED),I.dismiss(),I.success("Successfully joined room!"),A(""),g(""),console.log("Joined room:",z)},N=()=>{a(U.DISCONNECTED),I.dismiss(),I.error("Username already exists in this room")},j=z=>{a(U.JOINED),I.dismiss(),I.success("Room created successfully!"),g(""),console.log("Room created:",z)};return i.on(f.ROOM_INFO_RESPONSE,k),i.on(f.PASSWORD_VALID,M),i.on(f.PASSWORD_INCORRECT,m),i.on(f.PASSWORD_REQUIRED,b),i.on(f.ERROR,y),i.on(f.JOIN_ACCEPTED,C),i.on(f.USERNAME_EXISTS,N),i.on(f.ROOM_CREATED,j),()=>{i.off(f.ROOM_INFO_RESPONSE,k),i.off(f.PASSWORD_VALID,M),i.off(f.PASSWORD_INCORRECT,m),i.off(f.PASSWORD_REQUIRED,b),i.off(f.ERROR,y),i.off(f.JOIN_ACCEPTED,C),i.off(f.USERNAME_EXISTS,N),i.off(f.ROOM_CREATED,j)}},[i,s.roomId,d]),r.useEffect(()=>{var k;s.roomId.length>0||(k=t.state)!=null&&k.roomId&&(n({...s,roomId:t.state.roomId}),s.username.length===0&&I.success("Enter your username"))},[s,(de=t.state)==null?void 0:de.roomId,n]),r.useEffect(()=>{if(o===U.DISCONNECTED&&!i.connected){i.connect();return}const k=sessionStorage.getItem("redirect")||!1;if(o===U.JOINED&&!k){const M=s.username;sessionStorage.setItem("redirect","true"),D(`/editor/${s.roomId}`,{state:{username:M}})}else o===U.JOINED&&k&&(sessionStorage.removeItem("redirect"),a(U.DISCONNECTED),i.disconnect(),i.connect())},[s,(ue=t.state)==null?void 0:ue.redirect,D,a,i,o]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex w-full max-w-[500px] flex-col items-center justify-center gap-4 p-4 sm:w-[500px] sm:p-8",children:[e.jsx("img",{src:$n,alt:"Logo",className:"w-full"}),s.roomId.length>=5&&e.jsx("div",{className:"w-full rounded-md bg-darkHover p-3 text-sm",children:S?e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx("div",{className:"h-2 w-2 animate-ping rounded-full bg-yellow-400"}),"Checking room..."]}):h?e.jsxs("div",{className:"text-green-400",children:["âœ“ Room found: ",h.room_name,h.has_password&&" (Password protected)",e.jsxs("div",{className:"text-xs text-gray-400",children:[h.user_count," user(s) online"]})]}):l?e.jsx("div",{className:"text-blue-400",children:"ðŸ†• New room will be created"}):e.jsx("div",{className:"text-gray-400",children:"Enter a Room ID to check availability"})}),e.jsxs("form",{onSubmit:he,className:"flex w-full flex-col gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"roomId",placeholder:"Room ID",className:"w-full rounded-md border border-gray-500 bg-darkHover px-3 py-3 focus:outline-none",onChange:F,value:s.roomId}),l&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"rounded bg-blue-500 px-2 py-1 text-xs text-white",children:"NEW"})})]}),e.jsx("input",{type:"text",name:"username",placeholder:"Username",className:"w-full rounded-md border border-gray-500 bg-darkHover px-3 py-3 focus:outline-none",onChange:F,value:s.username,ref:$}),l&&e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:G?"text":"password",placeholder:"Room Password (optional)",className:"w-full rounded-md border border-gray-500 bg-darkHover px-3 py-3 pr-10 focus:outline-none",value:d,onChange:q}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",onClick:se,children:G?e.jsx(Fe,{}):e.jsx(Ae,{})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"rememberMe",checked:w,onChange:te,className:"h-4 w-4 rounded border-gray-500 bg-darkHover text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:"rememberMe",className:"text-sm text-gray-300",children:"Remember me"})]}),e.jsx("button",{type:"submit",className:"mt-2 w-full rounded-md bg-primary px-8 py-3 text-lg font-semibold text-black disabled:opacity-50",disabled:o===U.ATTEMPTING_JOIN,children:o===U.ATTEMPTING_JOIN?l?"Creating...":"Joining...":l?"Create Room":"Join Room"})]}),e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("button",{className:"cursor-pointer select-none underline",onClick:H,children:"Generate Unique Room ID"}),localStorage.getItem("rememberMe")==="true"&&e.jsx("button",{className:"cursor-pointer select-none text-sm text-red-400 underline",onClick:()=>{localStorage.removeItem("savedUsername"),localStorage.removeItem("savedRoomId"),localStorage.removeItem("rememberMe"),u(!1),n({...s,username:"",roomId:""}),I.success("Saved credentials cleared")},children:"Clear saved"})]})]}),p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"w-full max-w-md rounded-lg bg-dark p-6 shadow-xl",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold",children:"Room Password Required"}),e.jsx("p",{className:"mb-4 text-sm text-gray-300",children:"This room is protected with a password. Please enter the password to join."}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:W?"text":"password",placeholder:"Enter room password",className:"w-full rounded-md border border-gray-500 bg-darkHover px-3 py-3 pr-10 focus:outline-none",value:d,onChange:q,ref:R,autoFocus:!0,onKeyDown:k=>{k.key==="Enter"&&le()}}),e.jsx("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-300",onClick:ee,children:W?e.jsx(Fe,{}):e.jsx(Ae,{})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:le,className:"flex-1 rounded-md bg-primary px-4 py-2 font-semibold text-black",children:"Join Room"}),e.jsx("button",{onClick:()=>{x(!1),g(""),A("")},className:"flex-1 rounded-md border border-gray-500 px-4 py-2 font-semibold",children:"Cancel"})]})]})})]})};function Vn(){return e.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center gap-16",children:e.jsxs("div",{className:"my-12 flex h-full min-w-full flex-col items-center justify-evenly sm:flex-row sm:pt-0",children:[e.jsx("div",{className:"flex w-full animate-up-down justify-center sm:w-1/2 sm:pl-4",children:e.jsx("img",{src:Jn,alt:"Code Editor Illustration",className:"mx-auto w-[250px] sm:w-[400px]"})}),e.jsx("div",{className:"flex w-full items-center justify-center sm:w-1/2",children:e.jsx(Yn,{})})]})})}const Bn=()=>e.jsxs(e.Fragment,{children:[e.jsx(at,{children:e.jsxs(Ls,{children:[e.jsx(ke,{path:"/",element:e.jsx(Vn,{})}),e.jsx(ke,{path:"/editor/:roomId",element:e.jsx(Wn,{})})]})}),e.jsx(Ws,{})," ",e.jsx(Gs,{})]});function qn({children:t}){return e.jsx(Js,{children:e.jsx(Ys,{children:e.jsx(zs,{children:e.jsx(Nn,{children:e.jsx(on,{children:e.jsx(tn,{children:e.jsx(xn,{children:e.jsx(Vs,{children:t})})})})})})})})}it.createRoot(document.getElementById("root")).render(e.jsx(qn,{children:e.jsx(Bn,{})}));
