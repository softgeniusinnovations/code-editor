import{_ as C,b as n}from"./@babel-pqmwtNTb.js";import{R as u,r as $}from"./react-xe4jsmfW.js";import{P as s}from"./prop-types-yNpOvJnk.js";import{r as J}from"./is-retina-BzLP6e3E.js";import{m as K}from"./md5-d1KzqBq9.js";const q="react-avatar/",R="failing",O=(function(){try{return"localStorage"in window&&window.localStorage}catch{return!1}})();class x{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{cachePrefix:e=q,sourceTTL:r=168*3600*1e3,sourceSize:a=20}=t;this.cachePrefix=e,this.sourceTTL=r,this.sourceSize=a}set(t,e){if(O){e=JSON.stringify(e);try{localStorage.setItem(this.cachePrefix+t,e)}catch(r){console.error(r)}}}get(t){if(!O)return null;const e=localStorage.getItem(this.cachePrefix+t);return e?JSON.parse(e):null}sourceFailed(t){let e=this.get(R)||[];return e=e.filter(r=>{const a=r.expires>0&&r.expires<Date.now(),i=r===t||r.url==t;return!a&&!i}),e.unshift({url:t,expires:Date.now()+this.sourceTTL}),e=e.slice(0,this.sourceSize-1),this.set(R,e)}hasSourceFailedBefore(t){return(this.get(R)||[]).some(r=>{const a=r.expires>0&&r.expires<Date.now();return(r===t||r.url==t)&&!a})}}const X=new x,Y=J(),j=["#A62A21","#7e3794","#0B51C1","#3A6024","#A81563","#B3003C"],Q=/^([-+]?(?:\d+(?:\.\d+)?|\.\d+))([a-z]{2,4}|%)?$/;function Z(o,t){const e=[...o].map(l=>l.charCodeAt(0)),r=e.length,a=r%(t-1)+1,i=e.reduce((l,p)=>l+p)%t;let c=e[0]%t;for(let l=0;l<r;l++)c=(a*c+i)%t;return c}function P(o){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:j;if(!o)return"transparent";const e=Z(o,t.length);return t[e]}function S(o){o=""+o;const[,t=0,e="px"]=Q.exec(o)||[];return{value:parseFloat(t),str:t+e,unit:e}}function T(o){return o=S(o),isNaN(o.value)?o=512:o.unit==="px"?o=o.value:o.value===0?o=0:o=512,Y&&(o=o*2),o}function L(o,t){let{maxInitials:e}=t;return o.split(/\s/).map(r=>r.substring(0,1).toUpperCase()).filter(r=>!!r).slice(0,e).join("").toUpperCase()}const b={};function tt(o,t){if(b[t]){b[t].push(o);return}const e=b[t]=[o];setTimeout(()=>{delete b[t],e.forEach(r=>r())},t)}function w(){for(var o=arguments.length,t=new Array(o),e=0;e<o;e++)t[e]=arguments[e];for(const r of t){if(r||r==="")return r;if(r===!1||r===null)return null}}function I(o){if(o===!0)return"100%";if(o!==!1)return o}const E={cache:X,colors:j,initials:L,avatarRedirectUrl:null},et=Object.keys(E),_=u.createContext&&u.createContext(),N=!_,st=N?null:_.Consumer,rt=u.forwardRef||(o=>o);class g extends u.Component{_getContext(){const t={};return et.forEach(e=>{typeof this.props[e]<"u"&&(t[e]=this.props[e])}),t}render(){const{children:t}=this.props;return N?u.Children.only(t):u.createElement(_.Provider,{value:this._getContext()},u.Children.only(t))}}n(g,"displayName","ConfigProvider");n(g,"propTypes",{cache:s.object,colors:s.arrayOf(s.string),initials:s.func,avatarRedirectUrl:s.string,children:s.node});const U=o=>{function t(e,r){if(N){const a=r&&r.reactAvatar;return u.createElement(o,C({},E,a,e))}return u.createElement(st,null,a=>u.createElement(o,C({ref:r},E,a,e)))}return t.contextTypes=g.childContextTypes,rt(t)};N&&(g.childContextTypes={reactAvatar:s.object},g.prototype.getChildContext=function(){return{reactAvatar:this._getContext()}});class ot{constructor(){this.sourcePointer=0,this.active=!0,this.fetch=null}isActive(){return!((arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).internal!==this||!this.fetch||this.active!==!0)}}function nt(o,t,e){const{cache:r}=t,a=new o(t);if(!a.isCompatible(t))return e();a.get(i=>{!(i&&i.src&&r.hasSourceFailedBefore(i.src))&&i?e(i):e()})}function it(o){let{sources:t=[]}=o;const e=t.reduce((a,i)=>Object.assign(a,i.propTypes),{});class r extends $.PureComponent{constructor(i){super(i),n(this,"_createFetcher",c=>l=>{const{cache:p}=this.props;if(!c.isActive(this.state))return;l&&l.type==="error"&&p.sourceFailed(l.target.src);const h=c.sourcePointer;if(t.length===h)return;const d=t[h];c.sourcePointer++,nt(d,this.props,f=>{if(!f)return setTimeout(c.fetch,0);c.isActive(this.state)&&(f={src:null,value:null,color:null,...f},this.setState(m=>c.isActive(m)?f:{}))})}),n(this,"fetch",()=>{const c=new ot;c.fetch=this._createFetcher(c),this.setState({internal:c},c.fetch)}),this.state={internal:null,src:null,value:null,color:i.color}}componentDidMount(){this.fetch()}componentDidUpdate(i){let c=!1;for(const l in e)c=c||i[l]!==this.props[l];c&&setTimeout(this.fetch,0)}componentWillUnmount(){this.state.internal&&(this.state.internal.active=!1)}render(){const{children:i,propertyName:c}=this.props,{src:l,value:p,color:h,sourceName:d,internal:f}=this.state,m={src:l,value:p,color:h,sourceName:d,onRenderFailed:()=>f&&f.fetch()};if(typeof i=="function")return i(m);const v=u.Children.only(i);return u.cloneElement(v,{[c]:m})}}return n(r,"displayName","AvatarDataProvider"),n(r,"propTypes",{...e,cache:s.object,propertyName:s.string}),n(r,"defaultProps",{propertyName:"avatar"}),n(r,"Cache",x),n(r,"ConfigProvider",g),Object.assign(U(r),{ConfigProvider:g,Cache:x})}class z extends u.PureComponent{render(){const{className:t,unstyled:e,round:r,style:a,avatar:i,onClick:c,children:l}=this.props,{sourceName:p}=i,h=S(this.props.size),d=e?null:{display:"inline-block",verticalAlign:"middle",width:h.str,height:h.str,borderRadius:I(r),fontFamily:"Helvetica, Arial, sans-serif",...a},f=[t,"sb-avatar"];if(p){const m=p.toLowerCase().replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"");f.push("sb-avatar--"+m)}return u.createElement("div",{className:f.join(" "),onClick:c,style:d},l)}}n(z,"propTypes",{className:s.string,round:s.oneOfType([s.bool,s.string]),style:s.object,size:s.oneOfType([s.number,s.string]),unstyled:s.bool,avatar:s.object,onClick:s.func,children:s.node});class k extends u.PureComponent{render(){const{className:t,round:e,unstyled:r,alt:a,title:i,name:c,value:l,avatar:p}=this.props,h=S(this.props.size),d=r?null:{maxWidth:"100%",width:h.str,height:h.str,borderRadius:I(e)};return u.createElement(z,this.props,u.createElement("img",{className:t+" sb-avatar__image",width:h.str,height:h.str,style:d,src:p.src,alt:w(a,c||l),title:w(i,c||l),onError:p.onRenderFailed}))}}n(k,"propTypes",{alt:s.oneOfType([s.string,s.bool]),title:s.oneOfType([s.string,s.bool]),name:s.string,value:s.string,avatar:s.object,className:s.string,unstyled:s.bool,round:s.oneOfType([s.bool,s.string,s.number]),size:s.oneOfType([s.number,s.string])});n(k,"defaultProps",{className:"",round:!1,size:100,unstyled:!1});class F extends u.PureComponent{constructor(){var t;super(...arguments),t=this,n(this,"_scaleTextNode",function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16;const{unstyled:a,textSizeRatio:i,textMarginRatio:c,avatar:l}=t.props;if(t._node=e,!e||!e.parentNode||a||l.src||!t._mounted)return;const p=e.parentNode,h=p.parentNode,{width:d,height:f}=p.getBoundingClientRect();if(d==0&&f==0){const y=Math.min(r*1.5,500);tt(()=>t._scaleTextNode(e,y),y);return}if(!h.style.fontSize){const y=f/i;h.style.fontSize="".concat(y,"px")}p.style.fontSize=null;const{width:m}=e.getBoundingClientRect();if(m<0)return;const v=d*(1-2*c);m>v&&(p.style.fontSize="calc(1em * ".concat(v/m,")"))})}componentDidMount(){this._mounted=!0,this._scaleTextNode(this._node)}componentWillUnmount(){this._mounted=!1}render(){const{className:t,round:e,unstyled:r,title:a,name:i,value:c,avatar:l}=this.props,p=S(this.props.size),h=r?null:{width:p.str,height:p.str,lineHeight:"initial",textAlign:"center",color:this.props.fgColor,background:l.color,borderRadius:I(e)},d=r?null:{display:"table",tableLayout:"fixed",width:"100%",height:"100%"},f=r?null:{display:"table-cell",verticalAlign:"middle",fontSize:"100%",whiteSpace:"nowrap"},m=[l.value,this.props.size].join("");return u.createElement(z,this.props,u.createElement("div",{className:t+" sb-avatar__text",style:h,title:w(a,i||c)},u.createElement("div",{style:d},u.createElement("span",{style:f},u.createElement("span",{ref:this._scaleTextNode,key:m},l.value)))))}}n(F,"propTypes",{name:s.string,value:s.string,avatar:s.object,title:s.oneOfType([s.string,s.bool]),className:s.string,unstyled:s.bool,fgColor:s.string,textSizeRatio:s.number,textMarginRatio:s.number,round:s.oneOfType([s.bool,s.string,s.number]),size:s.oneOfType([s.number,s.string])});n(F,"defaultProps",{className:"",fgColor:"#FFF",round:!1,size:100,textSizeRatio:3,textMarginRatio:.15,unstyled:!1});function at(o){const t=it(o),e=U(u.forwardRef((r,a)=>u.createElement(t,C({},r,{propertyName:"avatar"}),i=>{const c=i.src?k:F;return u.createElement(c,C({},r,{avatar:i,ref:a}))})));return Object.assign(e,{getRandomColor:P,ConfigProvider:g,Cache:x})}class D{constructor(t){n(this,"props",null),n(this,"isCompatible",()=>!!this.props.email||!!this.props.md5Email),n(this,"get",e=>{const{props:r}=this,a=r.md5Email||K(r.email),i=T(r.size);let c="https://secure.gravatar.com/avatar/".concat(a,"?d=404");i&&(c+="&s=".concat(i)),e({sourceName:"gravatar",src:c})}),this.props=t}}n(D,"propTypes",{email:s.string,md5Email:s.string});class B{constructor(t){n(this,"props",null),n(this,"isCompatible",()=>!!this.props.facebookId),n(this,"get",e=>{const{facebookId:r}=this.props,a=T(this.props.size);let i="https://graph.facebook.com/".concat(r,"/picture");a&&(i+="?width=".concat(a,"&height=").concat(a)),e({sourceName:"facebook",src:i})}),this.props=t}}n(B,"propTypes",{facebookId:s.string});class H{constructor(t){n(this,"props",null),n(this,"isCompatible",()=>!!this.props.githubHandle),n(this,"get",e=>{const{githubHandle:r}=this.props,a=T(this.props.size);let i="https://avatars.githubusercontent.com/".concat(r,"?v=4");a&&(i+="&s=".concat(a)),e({sourceName:"github",src:i})}),this.props=t}}n(H,"propTypes",{githubHandle:s.string});class M{constructor(t){n(this,"props",null),n(this,"isCompatible",()=>!!this.props.skypeId),n(this,"get",e=>{const{skypeId:r}=this.props,a="https://api.skype.com/users/".concat(r,"/profile/avatar");e({sourceName:"skype",src:a})}),this.props=t}}n(M,"propTypes",{skypeId:s.string});class W{constructor(t){n(this,"props",null),n(this,"isCompatible",()=>!!(this.props.name||this.props.value||this.props.email)),n(this,"get",e=>{const r=this.getValue();if(!r)return e(null);e({sourceName:"text",value:r,color:this.getColor()})}),this.props=t}getInitials(){const{name:t,initials:e}=this.props;return typeof e=="string"?e:typeof e=="function"?e(t,this.props):L(t,this.props)}getValue(){return this.props.name?this.getInitials():this.props.value?this.props.value:null}getColor(){const{color:t,colors:e,name:r,email:a,value:i}=this.props;return t||P(r||a||i,e)}}n(W,"propTypes",{color:s.string,name:s.string,value:s.string,email:s.string,maxInitials:s.number,initials:s.oneOfType([s.string,s.func])});class G{constructor(t){n(this,"props",null),n(this,"isCompatible",()=>!!this.props.src),n(this,"get",e=>{e({sourceName:"src",src:this.props.src})}),this.props=t}}n(G,"propTypes",{src:s.string});class V{constructor(t){n(this,"props",null),n(this,"icon","âœ·"),n(this,"isCompatible",()=>!0),n(this,"get",e=>{const{color:r,colors:a}=this.props;e({sourceName:"icon",value:this.icon,color:r||P(this.icon,a)})}),this.props=t}}n(V,"propTypes",{color:s.string});function A(o,t){var e;return e=class{constructor(a){n(this,"props",null),n(this,"isCompatible",()=>!!this.props.avatarRedirectUrl&&!!this.props[t]),n(this,"get",i=>{const{avatarRedirectUrl:c}=this.props,l=T(this.props.size),p=c.replace(/\/*$/,"/"),h=this.props[t],d=l?"size=".concat(l):"",f="".concat(p).concat(o,"/").concat(h,"?").concat(d);i({sourceName:o,src:f})}),this.props=a}},n(e,"propTypes",{[t]:s.oneOfType([s.string,s.number])}),e}const ct=A("twitter","twitterHandle"),lt=A("vkontakte","vkontakteId"),ut=A("instagram","instagramId"),pt=A("google","googleId"),ht=[B,pt,H,ct,ut,lt,M,D,G,W,V],bt=at({sources:ht});export{bt as A};
