import{r as a,j as t}from"./react-xe4jsmfW.js";import{a as Be}from"./react-dom-CDP_2C_w.js";import{B as qe}from"./react-router-dom-CZaejiF4.js";import{F as Qe,n as R,z as k}from"./react-hot-toast-BWCWS8kw.js";import{l as Xe}from"./socket.io-client-BM-Eb1Rs.js";import{L as Ke,a as ue,b as Ze,c as et,R as tt,d as nt,e as st,A as rt,f as ot,P as be,M as ve,T as it,B as at,g as Ee,I as lt,G as ct,h as ut,i as dt,j as mt,k as ft,l as pt,m as ht,n as gt,o as xt,p as wt}from"./react-icons-CfVWXe2a.js";import{v as H}from"./uuid-CtRu48qb.js";import{a as je}from"./axios-B9ygI19o.js";import{F as yt}from"./file-saver-DXLm0zc3.js";import{J as Ct}from"./jszip-BYW2XS47.js";import{M as bt}from"./react-markdown-Cuyo6ip9.js";import{h as vt,d as Et}from"./react-syntax-highlighter-DMpjYQye.js";import{I as jt}from"./vscode-icons-js-DUdIxQfY.js";import{I as Ne}from"./@iconify-INkOFpyZ.js";import{c as ee}from"./classnames-Dty2DWCt.js";import{l as Se}from"./lang-map-nLg5Kdxm.js";import{x as Nt,a as St,w as Dt,b as kt,v as It,t as Rt,c as Lt,d as Tt,e as Ot,s as Ft,f as At,g as Pt,r as _t,q as Mt,o as Ut,n as zt,h as Ht,m as Gt,i as $t,j as Yt,k as Wt,l as Jt,p as Vt,u as Bt,y as qt,z as Qt,A as Xt,B as Kt,C as Zt,D as en,E as tn,F as nn,G as sn,H as rn,I as on,J as an,K as ln,L as cn,M as un,N as dn,O as mn,P as fn,Q as pn,R as hn,S as gn,T as xn,U as wn,V as yn}from"./@uiw-C3tmGjRq.js";import{A as Cn}from"./react-avatar-CEX1TIQS.js";import{u as ie,a as bn,b as De,c as vn,d as he}from"./react-router-BRbsMqEq.js";import{S as En}from"./react-split-s72OsX8P.js";import{M as ke}from"./react-tooltip-DN-mCcUm.js";import"./core-js-C7DbFKwg.js";import{u as jn}from"./@tldraw-p3oJsSm0.js";import"./lodash.throttle-yuuEgjvB.js";import"./lodash.uniq-u0GOvbqz.js";import"./lodash.isequal-CX3c-88x.js";import"./idb-Bn1DMRyg.js";import{T as Nn}from"./tldraw-DKVnECBa.js";import"./lz-string-DQU_J7vJ.js";import"./hotkeys-js-BxEwhL3V.js";import{bQ as Sn,bR as Dn,E as de,bj as oe,bk as kn,bS as In}from"./@codemirror-D8nkFkXT.js";import{s as ge}from"./screenfull-DmVOzVZz.js";import"./charenc-CI8Jn5z4.js";import"./scheduler-CoSDG3-6.js";import"./@remix-run-BpfYDNJ8.js";import"./goober-wofAfydu.js";import"./engine.io-client-CfqhKr8h.js";import"./engine.io-parser-BiEtp6m2.js";import"./@socket.io-Dkula2eQ.js";import"./socket.io-parser-BBkuslX-.js";import"./devlop-Cl3hj7Sz.js";import"./unified-BVfCCR4t.js";import"./bail-FqpXQuLt.js";import"./extend-D1C0LVzC.js";import"./is-plain-obj-C1gvLhAf.js";import"./trough-B_b8ryxu.js";import"./vfile-DoIswyph.js";import"./vfile-message-Ezj_CYSE.js";import"./unist-util-stringify-position-Ch_qCilz.js";import"./remark-parse-C8jcMe6G.js";import"./mdast-util-from-markdown-CgCUhJTR.js";import"./micromark-util-decode-numeric-character-reference-CNs1qBpV.js";import"./micromark-util-decode-string-strjl-tx.js";import"./decode-named-character-reference-C3-224fz.js";import"./micromark-util-normalize-identifier-C9ANKk3v.js";import"./micromark-DhRKOnvZ.js";import"./micromark-util-combine-extensions-Bka6Sc1c.js";import"./micromark-util-chunked-DrRIdSP-.js";import"./micromark-factory-space-CA-Wq7KA.js";import"./micromark-util-character-Ch8j4vtg.js";import"./micromark-core-commonmark-CDnWrFBr.js";import"./micromark-util-classify-character-GCpR5yWH.js";import"./micromark-util-resolve-all-PQCKh0dx.js";import"./micromark-util-subtokenize-BC4BSQ9J.js";import"./micromark-factory-destination-CkgxUJuk.js";import"./micromark-factory-label-U15tx9Nh.js";import"./micromark-factory-title-reCpaPbc.js";import"./micromark-factory-whitespace-_v4v79HM.js";import"./micromark-util-html-tag-name-DbKNfynz.js";import"./mdast-util-to-string-C_aolqmU.js";import"./remark-rehype-lIbojaYD.js";import"./mdast-util-to-hast-C1lZlDm6.js";import"./@ungap--gfxRhYI.js";import"./micromark-util-sanitize-uri-WGc3xW3f.js";import"./unist-util-position-60F3QETU.js";import"./trim-lines-D8znQY54.js";import"./unist-util-visit-CWHsnU7X.js";import"./unist-util-visit-parents-DZMunsV6.js";import"./unist-util-is-BPZGFiMU.js";import"./hast-util-to-jsx-runtime-CPS_PIgD.js";import"./comma-separated-tokens-xMQ5YY98.js";import"./property-information-Bx45xMUt.js";import"./space-separated-tokens-DD3iYX1K.js";import"./style-to-js-BPjnuCk7.js";import"./style-to-object-Cg2xzs12.js";import"./inline-style-parser-BlqBsVO4.js";import"./hast-util-whitespace-D4Wp6AEg.js";import"./estree-util-is-identifier-name-BgBfM8ME.js";import"./html-url-attributes-D46m5wfe.js";import"./@babel-pqmwtNTb.js";import"./refractor-De9CcUcl.js";import"./hastscript-Cxyc55ZY.js";import"./xtend-VQg9yHl6.js";import"./hast-util-parse-selector-BXt8oe2z.js";import"./parse-entities-C6euGolz.js";import"./character-reference-invalid-AKrgFUtc.js";import"./is-decimal-Bg2oiju0.js";import"./is-hexadecimal-yh8m6GRc.js";import"./is-alphanumerical-_oBzrqVk.js";import"./is-alphabetical-BQ1fjZEF.js";import"./@lezer-Bc0n9ZzW.js";import"./@replit-Z3Y5JSVX.js";import"./colors-named-CSGyx1iI.js";import"./colors-named-hex-Db6HdBCI.js";import"./hsl-matcher-CyxH9sTP.js";import"./prop-types-yNpOvJnk.js";import"./is-retina-BzLP6e3E.js";import"./md5-d1KzqBq9.js";import"./crypt-C-Yx0DM0.js";import"./is-buffer-DMJNLjvk.js";import"./split.js-CPyVEc61.js";import"./@floating-ui-Dttr1Bto.js";import"./nanoid-vcSNLBTf.js";import"./@use-gesture-DOFCekvX.js";import"./eventemitter3-Dqjbdtcb.js";import"./@radix-ui-7FXfGXGO.js";import"./react-remove-scroll-DaQnJUT6.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-wXCc6S34.js";import"./react-style-singleton-C2vgJe_j.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-DjRnOWoj.js";import"./use-callback-ref-B2lVNl4n.js";import"./aria-hidden-DvXkyWUv.js";import"./canvas-size-By42e4U-.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bs6eFhZE.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function s(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=s(o);fetch(o.href,i)}})();function Ie(){return{setItem:(r,o)=>{localStorage.setItem(r,o)},getItem:r=>localStorage.getItem(r),removeItem:r=>{localStorage.removeItem(r)}}}const Re=a.createContext(null),re=()=>{const e=a.useContext(Re);if(!e)throw new Error("useSettings must be used within a SettingContextProvider");return e},$={theme:"Dracula",language:"Javascript",fontSize:16,fontFamily:"Space Mono",showGitHubCorner:!0};function Rn({children:e}){const{getItem:n}=Ie(),s=JSON.parse(n("settings")||"{}"),r=s.theme!==void 0?s.theme:$.theme,o=s.language!==void 0?s.language:$.language,i=s.fontSize!==void 0?s.fontSize:$.fontSize,u=s.fontFamily!==void 0?s.fontFamily:$.fontFamily,l=s.showGitHubCorner!==void 0?s.showGitHubCorner:$.showGitHubCorner,[c,d]=a.useState(r),[p,x]=a.useState(o),[f,h]=a.useState(i),[m,E]=a.useState(u),[S,C]=a.useState(l),T=()=>{d($.theme),x($.language),h($.fontSize),E($.fontFamily),C($.showGitHubCorner)};return a.useEffect(()=>{const A={theme:c,language:p,fontSize:f,fontFamily:m,showGitHubCorner:S};localStorage.setItem("settings",JSON.stringify(A))},[c,p,f,m,S]),t.jsx(Re.Provider,{value:{theme:c,setTheme:d,language:p,setLanguage:x,fontSize:f,setFontSize:h,fontFamily:m,setFontFamily:E,showGitHubCorner:S,setShowGitHubCorner:C,resetSettings:T},children:e})}function Q(){const[e,n]=a.useState({width:window.innerWidth,height:window.innerHeight}),[s,r]=a.useState(window.innerWidth<768);return a.useEffect(()=>{const o=()=>{n({width:window.innerWidth,height:window.innerHeight}),r(window.innerWidth<768)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]),{...e,isMobile:s}}function Ln(){const{showGitHubCorner:e}=re(),{width:n}=Q();return t.jsx("a",{href:"https://github.com/smshagor-dev",className:"github-corner","aria-label":"View source on GitHub",target:"_blank",rel:"noreferrer",style:{display:e&&n>640?"block":"none"},children:t.jsx("svg",{width:"150",height:"100",viewBox:"0 0 250 250",className:"absolute right-0 top-0 z-10 border-none bg-primary text-gray-900 dark:text-gray-100","aria-hidden":"true",style:{color:"#151513",transform:"rotate(45deg) translate(12%,-80%) scale(0.8)"},children:t.jsxs("g",{style:{transform:"rotate(-45deg) translate(0%,50%)",transformOrigin:"bottom"},children:[t.jsx("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{transformOrigin:"130px 106px"},className:"octo-arm"}),t.jsx("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",className:"octo-body"})]})})})}function Tn(){return t.jsx(Qe,{position:"top-right"})}var Y=(e=>(e.CODING="coding",e.DRAWING="drawing",e))(Y||{}),se=(e=>(e.OFFLINE="offline",e.ONLINE="online",e))(se||{}),M=(e=>(e.INITIAL="initial",e.CONNECTING="connecting",e.ATTEMPTING_JOIN="attempting-join",e.JOINED="joined",e.CONNECTION_FAILED="connection-failed",e.DISCONNECTED="disconnected",e))(M||{});const Le=a.createContext(null),_=()=>{const e=a.useContext(Le);if(e===null)throw new Error("useAppContext must be used within a AppContextProvider");return e};function On({children:e}){const[n,s]=a.useState([]),[r,o]=a.useState(M.INITIAL),[i,u]=a.useState({username:"",roomId:""}),[l,c]=a.useState(Y.CODING),[d,p]=a.useState(null);return t.jsx(Le.Provider,{value:{users:n,setUsers:s,currentUser:i,setCurrentUser:u,status:r,setStatus:o,activityState:l,setActivityState:c,drawingData:d,setDrawingData:p},children:e})}var w=(e=>(e.JOIN_REQUEST="join-request",e.JOIN_ACCEPTED="join-accepted",e.USER_JOINED="user-joined",e.USER_DISCONNECTED="user-disconnected",e.SYNC_FILE_STRUCTURE="sync-file-structure",e.DIRECTORY_CREATED="directory-created",e.DIRECTORY_UPDATED="directory-updated",e.DIRECTORY_RENAMED="directory-renamed",e.DIRECTORY_DELETED="directory-deleted",e.FILE_CREATED="file-created",e.FILE_UPDATED="file-updated",e.FILE_RENAMED="file-renamed",e.FILE_DELETED="file-deleted",e.USER_OFFLINE="offline",e.USER_ONLINE="online",e.SEND_MESSAGE="send-message",e.RECEIVE_MESSAGE="receive-message",e.TYPING_START="typing-start",e.TYPING_PAUSE="typing-pause",e.CURSOR_MOVE="cursor-move",e.USERNAME_EXISTS="username-exists",e.REQUEST_DRAWING="request-drawing",e.SYNC_DRAWING="sync-drawing",e.DRAWING_UPDATE="drawing-update",e))(w||{});const Te=a.createContext(null),G=()=>{const e=a.useContext(Te);if(!e)throw new Error("useSocket must be used within a SocketProvider");return e},Fn="https://cloud.code-editor.ru",An=({children:e})=>{const{users:n,setUsers:s,setStatus:r,setCurrentUser:o,drawingData:i,setDrawingData:u}=_(),l=a.useMemo(()=>Xe(Fn,{reconnectionAttempts:2}),[]),c=a.useCallback(m=>{console.log("socket error",m),r(M.CONNECTION_FAILED),R.dismiss(),R.error("Failed to connect to the server")},[r]),d=a.useCallback(()=>{R.dismiss(),r(M.INITIAL),R.error("The username you chose already exists in the room. Please choose a different username.")},[r]),p=a.useCallback(({user:m,users:E})=>{o(m),s(E),R.dismiss(),r(M.JOINED),E.length>1&&R.loading("Syncing data, please wait...")},[o,r,s]),x=a.useCallback(({user:m})=>{R.success(`${m.username} left the room`),s(n.filter(E=>E.username!==m.username))},[s,n]),f=a.useCallback(({socketId:m})=>{l.emit(w.SYNC_DRAWING,{socketId:m,drawingData:i})},[i,l]),h=a.useCallback(({drawingData:m})=>{u(m)},[u]);return a.useEffect(()=>(l.on("connect_error",c),l.on("connect_failed",c),l.on(w.USERNAME_EXISTS,d),l.on(w.JOIN_ACCEPTED,p),l.on(w.USER_DISCONNECTED,x),l.on(w.REQUEST_DRAWING,f),l.on(w.SYNC_DRAWING,h),()=>{l.off("connect_error"),l.off("connect_failed"),l.off(w.USERNAME_EXISTS),l.off(w.JOIN_ACCEPTED),l.off(w.USER_DISCONNECTED),l.off(w.REQUEST_DRAWING),l.off(w.SYNC_DRAWING)}),[h,c,p,f,x,d,s,l]),t.jsx(Te.Provider,{value:{socket:l},children:e})},Oe=a.createContext(null),me=()=>{const e=a.useContext(Oe);if(!e)throw new Error("useChatRoom must be used within a ChatContextProvider");return e};function Pn({children:e}){const{socket:n}=G(),[s,r]=a.useState([]),[o,i]=a.useState(!1),[u,l]=a.useState(0);return a.useEffect(()=>(n.on(w.RECEIVE_MESSAGE,({message:c})=>{r(d=>[...d,c]),i(!0)}),()=>{n.off(w.RECEIVE_MESSAGE)}),[n]),t.jsx(Oe.Provider,{value:{messages:s,setMessages:r,isNewMessage:o,setIsNewMessage:i,lastScrollHeight:u,setLastScrollHeight:l},children:e})}function _n(e){const n=new Date(e);let s=n.getHours();const r=String(n.getMinutes()).padStart(2,"0"),o=s>=12?"PM":"AM";return s=s%12,s=s||12,`${s}:${r} ${o}`}function Mn(){const{currentUser:e}=_(),{socket:n}=G(),{setMessages:s}=me(),r=a.useRef(null),o=i=>{var l;i.preventDefault();const u=(l=r.current)==null?void 0:l.value.trim();if(u&&u.length>0){const c={id:H(),message:u,username:e.username,timestamp:_n(new Date().toISOString())};n.emit(w.SEND_MESSAGE,{message:c}),s(d=>[...d,c]),r.current&&(r.current.value="")}};return t.jsxs("form",{onSubmit:o,className:"flex justify-between rounded-md border border-primary",children:[t.jsx("input",{type:"text",className:"w-full flex-grow rounded-md border-none bg-dark p-2 outline-none",placeholder:"Enter a message...",ref:r}),t.jsx("button",{className:"flex items-center justify-center rounded-r-md  bg-primary p-2 text-black",type:"submit",children:t.jsx(Ke,{size:24})})]})}function Un(){const{messages:e,isNewMessage:n,setIsNewMessage:s,lastScrollHeight:r,setLastScrollHeight:o}=me(),{currentUser:i}=_(),u=a.useRef(null),l=c=>{const d=c.target;o(d.scrollTop)};return a.useEffect(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[e]),a.useEffect(()=>{n&&s(!1),u.current&&(u.current.scrollTop=r)},[n,s,r]),t.jsx("div",{className:"flex-grow overflow-auto rounded-md bg-darkHover p-2",ref:u,onScroll:l,children:e.map((c,d)=>t.jsxs("div",{className:"mb-2 w-[80%] self-end break-words rounded-md bg-dark px-3 py-2"+(c.username===i.username?" ml-auto ":""),children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-xs text-primary",children:c.username}),t.jsx("span",{className:"text-xs text-white",children:c.timestamp})]}),t.jsx("p",{className:"py-1",children:c.message})]},d))})}function U(){const[e,n]=a.useState(!1),{height:s,isMobile:r}=Q(),[o,i]=a.useState(s);return a.useEffect(()=>{s<500&&r?(n(!0),i(s)):r?(n(!1),i(s-50)):(n(!1),i(s))},[s,r,o]),{viewHeight:o,minHeightReached:e}}const zn=()=>{const{viewHeight:e}=U();return t.jsxs("div",{className:"flex max-h-full min-h-[400px] w-full flex-col gap-2 p-4",style:{height:e},children:[t.jsx("h1",{className:"view-title",children:"Group Chat"}),t.jsx(Un,{}),t.jsx(Mn,{})]})},Hn="https://text.pollinations.ai",Gn=je.create({baseURL:Hn,headers:{"Content-Type":"application/json"}}),Fe=a.createContext(null),$n=()=>{const e=a.useContext(Fe);if(e===null)throw new Error("useCopilot must be used within a CopilotContextProvider");return e},Yn=({children:e})=>{const[n,s]=a.useState(""),[r,o]=a.useState(""),[i,u]=a.useState(!1),l=async()=>{try{if(n.length===0){k.error("Please write a prompt");return}k.loading("Generating code..."),u(!0);const c=await Gn.post("/",{messages:[{role:"system",content:"You are a code generator copilot for project named Code Editor. Generate code based on the given prompt without any explanation. Return only the code, formatted in Markdown using the appropriate language syntax (e.g., js for JavaScript, py for Python). Do not include any additional text or explanations. If you don't know the answer, respond with 'I don't know'."},{role:"user",content:n}],model:"mistral",private:!0});if(c.data){k.success("Code generated successfully");const d=c.data;d&&o(d)}u(!1),k.dismiss()}catch(c){console.error(c),u(!1),k.dismiss(),k.error("Failed to generate the code")}};return t.jsx(Fe.Provider,{value:{setInput:s,output:r,isRunning:i,generateCode:l},children:e})},Wn=`function sayHi() {
  console.log("ðŸ‘‹ Hello world");
}

sayHi()`,Jn={name:"root",id:H(),type:"directory",children:[{id:H(),type:"file",name:"index.js",content:Wn}]},Ae=(e,n)=>{if(e.id===n&&e.type==="directory")return e;if(e.type==="directory"&&e.children)for(const s of e.children){const r=Ae(s,n);if(r)return r}return null},xe=(e,n)=>e.children?e.children.some(s=>s.name===n):!1,Vn=(e,n)=>{const s=r=>{if(r.id===n)return r;if(r.children)for(const o of r.children){const i=s(o);if(i)return i}return null};return s(e)},Pe=e=>{if(e.type==="directory"&&e.children){let n=e.children.filter(r=>r.type==="directory");const s=e.children.filter(r=>r.type==="file");n.sort((r,o)=>r.name.localeCompare(o.name)),n=n.map(r=>Pe(r)),s.sort((r,o)=>r.name.localeCompare(o.name)),e.children=[...n.filter(r=>r.name.startsWith(".")),...n.filter(r=>!r.name.startsWith(".")),...s.filter(r=>r.name.startsWith(".")),...s.filter(r=>!r.name.startsWith("."))]}return e},_e=a.createContext(null),W=()=>{const e=a.useContext(_e);if(!e)throw new Error("useFileSystem must be used within FileContextProvider");return e};function Bn({children:e}){const{socket:n}=G(),{setUsers:s,drawingData:r}=_(),[o,i]=a.useState(Jn),u=o.children?o.children:[],[l,c]=a.useState(u),[d,p]=a.useState(l[0]),x=g=>{const y=v=>v.id===g?{...v,isOpen:!v.isOpen}:v.children?{...v,children:v.children.map(y)}:v;i(v=>y(v))},f=()=>{const g=y=>{var v;return{...y,isOpen:!1,children:(v=y.children)==null?void 0:v.map(g)}};i(y=>g(y))},h=a.useCallback((g,y,v=!0)=>{let b;typeof y=="string"?b={id:H(),name:y,type:"directory",children:[],isOpen:!1}:b=y,g||(g=o.id);const j=N=>N.id===g?{...N,children:[...N.children||[],b]}:N.children?{...N,children:N.children.map(j)}:N;return i(N=>j(N)),v&&n.emit(w.DIRECTORY_CREATED,{parentDirId:g,newDirectory:b}),b.id},[o.id,n]),m=a.useCallback((g,y,v=!0)=>{g||(g=o.id);const b=j=>j.id===g?{...j,children:y}:j.children?{...j,children:j.children.map(b)}:j;i(j=>b(j)),c([]),p(null),g===o.id&&(R.dismiss(),R.success("Files and folders updated")),v&&n.emit(w.DIRECTORY_UPDATED,{dirId:g,children:y})},[o.id,n]),E=a.useCallback((g,y,v=!0)=>{const b=N=>N.type==="directory"&&N.children?N.children.some(D=>D.type==="directory"&&D.name===y&&D.id!==g)?null:{...N,children:N.children.map(D=>{if(D.id===g)return{...D,name:y};if(D.type==="directory"){const ne=b(D);return ne!==null?ne:D}else return D})}:N,j=b(o);return j===null?!1:(i(j),v&&n.emit(w.DIRECTORY_RENAMED,{dirId:g,newDirName:y}),!0)},[n,i,o]),S=a.useCallback((g,y=!0)=>{const v=b=>{if(b.type==="directory"&&b.id===g)return null;if(b.children){const j=b.children.map(v).filter(N=>N!==null);return{...b,children:j}}else return b};i(b=>v(b)),y&&n.emit(w.DIRECTORY_DELETED,{dirId:g})},[n]),C=g=>{const y=Vn(o,g);y&&(z((d==null?void 0:d.id)||"",(d==null?void 0:d.content)||""),l.some(v=>v.id===g)||c(v=>[...v,y]),c(v=>v.map(b=>b.id===(d==null?void 0:d.id)?{...b,content:d.content||""}:b)),p(y))},T=g=>{if(g===(d==null?void 0:d.id)){z(d.id,d.content||"");const y=l.findIndex(v=>v.id===g);y!==-1&&l.length>1?y>0?p(l[y-1]):p(l[y+1]):p(null)}c(y=>y.filter(v=>v.id!==g))},A=a.useCallback((g,y,v=!0)=>{let b=1;g||(g=o.id);const j=Ae(o,g);if(!j)throw new Error("Parent directory not found");let N;if(typeof y=="string"){let D=y,ne=xe(j,D);for(;ne;)D=`${D.split(".")[0]}(${b}).${D.split(".")[1]}`,ne=xe(j,D),b++;N={id:H(),name:D,type:"file",content:""}}else N=y;const le=D=>D.id===j.id?{...D,children:[...D.children||[],N],isOpen:!0}:D.children?{...D,children:D.children.map(le)}:D;return i(D=>le(D)),c(D=>[...D,N]),p(N),v&&n.emit(w.FILE_CREATED,{parentDirId:g,newFile:N}),N.id},[o,n]),z=a.useCallback((g,y)=>{const v=b=>b.type==="file"&&b.id===g?{...b,content:y}:b.children?{...b,children:b.children.map(v)}:b;i(b=>v(b)),l.some(b=>b.id===g)&&c(b=>b.map(j=>j.id===g?{...j,content:y}:j))},[l]),P=a.useCallback((g,y,v=!0)=>{const b=j=>j.type==="directory"&&j.children?{...j,children:j.children.map(N=>N.type==="file"&&N.id===g?{...N,name:y}:N)}:j;return i(j=>b(j)),c(j=>j.map(N=>N.id===g?{...N,name:y}:N)),g===(d==null?void 0:d.id)&&p(j=>j?{...j,name:y}:null),v&&n.emit(w.FILE_RENAMED,{fileId:g,newName:y}),!0},[d==null?void 0:d.id,n]),L=a.useCallback((g,y=!0)=>{const v=b=>{if(b.type==="directory"&&b.children){const j=b.children.map(N=>N.type==="directory"?v(N):N.id!==g?N:null).filter(N=>N!==null);return{...b,children:j}}else return b};i(b=>v(b)),l.some(b=>b.id===g)&&c(b=>b.filter(j=>j.id!==g)),(d==null?void 0:d.id)===g&&p(null),R.success("File deleted successfully"),y&&n.emit(w.FILE_DELETED,{fileId:g})},[d==null?void 0:d.id,l,n]),O=()=>{const g=new Ct,y=(v,b="")=>{const j=b+v.name+(v.type==="directory"?"/":"");if(v.type==="file")g.file(j,v.content||"");else if(v.type==="directory"&&v.children)for(const N of v.children)y(N,j)};if(o.type==="directory"&&o.children)for(const v of o.children)y(v);g.generateAsync({type:"blob"}).then(v=>{yt.saveAs(v,"download.zip")})},J=a.useCallback(({user:g})=>{R.success(`${g.username} joined the room`),n.emit(w.SYNC_FILE_STRUCTURE,{fileStructure:o,openFiles:l,activeFile:d,socketId:g.socketId}),n.emit(w.SYNC_DRAWING,{drawingData:r,socketId:g.socketId}),s(y=>[...y,g])},[d,r,o,l,s,n]),F=a.useCallback(({fileStructure:g,openFiles:y,activeFile:v})=>{i(g),c(y),p(v),R.dismiss()},[]),V=a.useCallback(({parentDirId:g,newDirectory:y})=>{h(g,y,!1)},[h]),X=a.useCallback(({dirId:g,children:y})=>{m(g,y,!1)},[m]),K=a.useCallback(({dirId:g,newName:y})=>{E(g,y,!1)},[E]),q=a.useCallback(({dirId:g})=>{S(g,!1)},[S]),B=a.useCallback(({parentDirId:g,newFile:y})=>{A(g,y,!1)},[A]),te=a.useCallback(({fileId:g,newContent:y})=>{z(g,y),(d==null?void 0:d.id)===g&&p({...d,content:y})},[d,z]),fe=a.useCallback(({fileId:g,newName:y})=>{P(g,y,!1)},[P]),pe=a.useCallback(({fileId:g})=>{L(g,!1)},[L]);return a.useEffect(()=>(n.once(w.SYNC_FILE_STRUCTURE,F),n.on(w.USER_JOINED,J),n.on(w.DIRECTORY_CREATED,V),n.on(w.DIRECTORY_UPDATED,X),n.on(w.DIRECTORY_RENAMED,K),n.on(w.DIRECTORY_DELETED,q),n.on(w.FILE_CREATED,B),n.on(w.FILE_UPDATED,te),n.on(w.FILE_RENAMED,fe),n.on(w.FILE_DELETED,pe),()=>{n.off(w.USER_JOINED),n.off(w.DIRECTORY_CREATED),n.off(w.DIRECTORY_UPDATED),n.off(w.DIRECTORY_RENAMED),n.off(w.DIRECTORY_DELETED),n.off(w.FILE_CREATED),n.off(w.FILE_UPDATED),n.off(w.FILE_RENAMED),n.off(w.FILE_DELETED)}),[V,q,K,X,B,pe,fe,F,te,J,n]),t.jsx(_e.Provider,{value:{fileStructure:o,openFiles:l,activeFile:d,setActiveFile:p,closeFile:T,toggleDirectory:x,collapseDirectories:f,createDirectory:h,updateDirectory:m,renameDirectory:E,deleteDirectory:S,openFile:C,createFile:A,updateFileContent:z,renameFile:P,deleteFile:L,downloadFilesAndFolders:O},children:e})}function qn(){const{socket:e}=G(),{viewHeight:n}=U(),{generateCode:s,output:r,isRunning:o,setInput:i}=$n(),{activeFile:u,updateFileContent:l,setActiveFile:c}=W(),d=async()=>{try{const f=r.replace(/```[\w]*\n?/g,"").trim();await navigator.clipboard.writeText(f),k.success("Output copied to clipboard")}catch(f){k.error("Unable to copy output to clipboard"),console.log(f)}},p=()=>{if(u){const h=`${u.content?`${u.content}
`:""}${r.replace(/```[\w]*\n?/g,"").trim()}`;l(u.id,h),c({...u,content:h}),k.success("Code pasted successfully"),e.emit(w.FILE_UPDATED,{fileId:u.id,newContent:h})}},x=()=>{if(u){if(!confirm("Are you sure you want to replace the code in the file?"))return;const h=r.replace(/```[\w]*\n?/g,"").trim();l(u.id,h),c({...u,content:h}),k.success("Code replaced successfully"),e.emit(w.FILE_UPDATED,{fileId:u.id,newContent:h})}};return t.jsxs("div",{className:"flex max-h-full min-h-[400px] w-full flex-col gap-2 p-4",style:{height:n},children:[t.jsx("h1",{className:"view-title",children:"Copilot"}),t.jsx("textarea",{className:"min-h-[120px] w-full rounded-md border-none bg-darkHover p-2 text-white outline-none",placeholder:"What code do you want to generate?",onChange:f=>i(f.target.value)}),t.jsx("button",{className:"mt-1 flex w-full justify-center rounded-md bg-primary p-2 font-bold text-black outline-none disabled:cursor-not-allowed disabled:opacity-50",onClick:s,disabled:o,children:o?"Generating...":"Generate Code"}),r&&t.jsxs("div",{className:"flex justify-end gap-4 pt-2",children:[t.jsx("button",{title:"Copy Output",onClick:d,children:t.jsx(ue,{size:18,className:"cursor-pointer text-white"})}),t.jsx("button",{title:"Replace code in file",onClick:x,children:t.jsx(Ze,{size:18,className:"cursor-pointer text-white"})}),t.jsx("button",{title:"Paste code in file",onClick:p,children:t.jsx(et,{size:18,className:"cursor-pointer text-white"})})]}),t.jsx("div",{className:"h-full rounded-lg w-full overflow-y-auto p-0",children:t.jsx(bt,{components:{code({inline:f,className:h,children:m,...E}){const S=/language-(\w+)/.exec(h||""),C=S?S[1]:"javascript";return f?t.jsx("code",{className:h,...E,children:m}):t.jsx(vt,{style:Et,language:C,PreTag:"pre",className:"!m-0 !h-full !rounded-lg !bg-gray-900 !p-2",children:String(m).replace(/\n$/,"")})},pre({children:f}){return t.jsx("pre",{className:"h-full",children:f})}},children:r})})]})}const Me=({ref:e})=>{const[n,s]=a.useState(!1),[r,o]=a.useState({x:0,y:0});return a.useEffect(()=>{const i=e.current;if(!i)return;const u=()=>{s(!1)},l=d=>{e.current&&e.current.contains(d.target)?(s(!0),o({x:d.pageX,y:d.pageY})):s(!1)},c=d=>{d.preventDefault(),s(!0),o({x:d.pageX,y:d.pageY})};return i.addEventListener("contextmenu",c),document.addEventListener("click",u),document.addEventListener("contextmenu",l),()=>{i.removeEventListener("contextmenu",c),document.removeEventListener("click",u),document.removeEventListener("contextmenu",l)}},[e]),{menuOpen:n,setMenuOpen:s,coords:r,setCoords:o}},Ue=e=>{var r;return`vscode-icons:${(r=jt.getIconForFile(e))==null?void 0:r.replace(/_/g,"-").split(".")[0]}`};function ze({id:e,preName:n,setEditing:s,type:r}){const[o,i]=a.useState(n||""),{renameFile:u,openFile:l,renameDirectory:c}=W(),d=a.useRef(null),p=h=>{h.preventDefault(),h.stopPropagation();const m=r.charAt(0).toUpperCase()+r.slice(1);if(o==="")k.error(`${m} name cannot be empty`);else if(o.length>25)k.error(`${m} name cannot be longer than 25 characters`);else if(o===n)k.error(`${m} name cannot be the same as before`);else{const E=r==="directory"?c(e,o):u(e,o);E&&r==="file"&&l(e),E?s(!1):k.error(`${m} with same name already exists`)}},x=a.useCallback(h=>{var m;h.key==="Enter"?(m=d.current)==null||m.requestSubmit():h.key==="Escape"&&s(!1)},[s]),f=a.useCallback(h=>{const m=d.current;m&&!m.contains(h.target)&&s(!1)},[s]);return a.useEffect(()=>{const h=d.current;if(h)return h.focus(),h.addEventListener("keydown",x),document.addEventListener("keydown",f),document.addEventListener("click",f),()=>{h.removeEventListener("keydown",x),document.removeEventListener("keydown",f),document.removeEventListener("click",f)}},[f,x,s]),t.jsx("div",{className:"rounded-md",children:t.jsx("form",{onSubmit:p,ref:d,className:"flex w-full items-center gap-2 rounded-md",children:t.jsx("input",{type:"text",className:"w-full flex-grow rounded-sm bg-dark px-2 text-base text-white outline-none",autoFocus:!0,value:o,onChange:h=>i(h.target.value)})})})}function Qn(){const{fileStructure:e,createFile:n,createDirectory:s,collapseDirectories:r}=W(),o=a.useRef(null),[i,u]=a.useState(null),{minHeightReached:l}=U(),c=f=>{o.current&&!o.current.contains(f.target)&&u(e.id)},d=()=>{const f=prompt("Enter file name");if(f){const h=i||e.id;n(h,f)}},p=()=>{const f=prompt("Enter directory name");if(f){const h=i||e.id;s(h,f)}},x=Pe(e);return t.jsxs("div",{onClick:c,className:"flex flex-grow flex-col",children:[t.jsxs("div",{className:"view-title flex justify-between",children:[t.jsx("h2",{children:"Files"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"rounded-md px-1 hover:bg-darkHover",onClick:d,title:"Create File",children:t.jsx(tt,{size:20})}),t.jsx("button",{className:"rounded-md px-1 hover:bg-darkHover",onClick:p,title:"Create Directory",children:t.jsx(nt,{size:20})}),t.jsx("button",{className:"rounded-md px-1 hover:bg-darkHover",onClick:r,title:"Collapse All Directories",children:t.jsx(st,{size:20})})]})]}),t.jsx("div",{className:ee("min-h-[200px] flex-grow overflow-auto pr-2 sm:min-h-0",{"h-[calc(80vh-170px)]":!l,"h-[85vh]":l}),ref:o,children:x.children&&x.children.map(f=>t.jsx(He,{item:f,setSelectedDirId:u},f.id))})]})}function He({item:e,setSelectedDirId:n}){const[s,r]=a.useState(!1),o=a.useRef(null),{coords:i,menuOpen:u,setMenuOpen:l}=Me({ref:o}),{deleteDirectory:c,toggleDirectory:d}=W(),p=h=>{n(h),d(h)},x=h=>{h.stopPropagation(),l(!1),r(!0)},f=(h,m)=>{h.stopPropagation(),l(!1),confirm("Are you sure you want to delete directory?")&&c(m)};return a.useEffect(()=>{const h=o.current;if(!h)return;h.tabIndex=0;const m=E=>{E.stopPropagation(),E.key==="F2"&&r(!0)};return h.addEventListener("keydown",m),()=>{h.removeEventListener("keydown",m)}},[]),e.type==="file"?t.jsx(Xn,{item:e,setSelectedDirId:n}):t.jsxs("div",{className:"overflow-x-auto",children:[t.jsxs("div",{className:"flex w-full items-center rounded-md px-2 py-1 hover:bg-darkHover",onClick:()=>p(e.id),ref:o,children:[e.isOpen?t.jsx(rt,{size:24,className:"mr-2 min-w-fit"}):t.jsx(ot,{size:24,className:"mr-2 min-w-fit"}),s?t.jsx(ze,{id:e.id,preName:e.name,type:"directory",setEditing:r}):t.jsx("p",{className:"flex-grow cursor-pointer overflow-hidden truncate",title:e.name,children:e.name})]}),t.jsx("div",{className:ee({hidden:!e.isOpen},{block:e.isOpen},{"pl-4":e.name!=="root"}),children:e.children&&e.children.map(h=>t.jsx(He,{item:h,setSelectedDirId:n},h.id))}),u&&t.jsx(Zn,{handleDeleteDirectory:f,handleRenameDirectory:x,id:e.id,left:i.x,top:i.y})]})}const Xn=({item:e,setSelectedDirId:n})=>{const{deleteFile:s,openFile:r}=W(),[o,i]=a.useState(!1),{setIsSidebarOpen:u}=ae(),{isMobile:l}=Q(),{activityState:c,setActivityState:d}=_(),p=a.useRef(null),{menuOpen:x,coords:f,setMenuOpen:h}=Me({ref:p}),m=C=>{o||(n(C),r(C),l&&u(!1),c===Y.DRAWING&&d(Y.CODING))},E=C=>{C.stopPropagation(),i(!0),h(!1)},S=(C,T)=>{C.stopPropagation(),h(!1),confirm("Are you sure you want to delete file?")&&s(T)};return a.useEffect(()=>{const C=p.current;if(!C)return;C.tabIndex=0;const T=A=>{A.stopPropagation(),A.key==="F2"&&i(!0)};return C.addEventListener("keydown",T),()=>{C.removeEventListener("keydown",T)}},[]),t.jsxs("div",{className:"flex w-full items-center rounded-md px-2 py-1 hover:bg-darkHover",onClick:()=>m(e.id),ref:p,children:[t.jsx(Ne,{icon:Ue(e.name),fontSize:22,className:"mr-2 min-w-fit"}),o?t.jsx(ze,{id:e.id,preName:e.name,type:"file",setEditing:i}):t.jsx("p",{className:"flex-grow cursor-pointer overflow-hidden truncate",title:e.name,children:e.name}),x&&t.jsx(Kn,{top:f.y,left:f.x,id:e.id,handleRenameFile:E,handleDeleteFile:S})]})},Kn=({top:e,left:n,id:s,handleRenameFile:r,handleDeleteFile:o})=>t.jsxs("div",{className:"absolute z-10 w-[150px] rounded-md border border-darkHover bg-dark p-1",style:{top:e,left:n},children:[t.jsxs("button",{onClick:r,className:"flex w-full items-center gap-2 rounded-md px-2 py-1 hover:bg-darkHover",children:[t.jsx(be,{size:18}),"Rename"]}),t.jsxs("button",{onClick:i=>o(i,s),className:"flex w-full items-center gap-2 rounded-md px-2 py-1 text-danger hover:bg-darkHover",children:[t.jsx(ve,{size:20}),"Delete"]})]}),Zn=({top:e,left:n,id:s,handleRenameDirectory:r,handleDeleteDirectory:o})=>t.jsxs("div",{className:"absolute z-10 w-[150px] rounded-md border border-darkHover bg-dark p-1",style:{top:e,left:n},children:[t.jsxs("button",{onClick:r,className:"flex w-full items-center gap-2 rounded-md px-2 py-1 hover:bg-darkHover",children:[t.jsx(be,{size:18}),"Rename"]}),t.jsxs("button",{onClick:i=>o(i,s),className:"flex w-full items-center gap-2 rounded-md px-2 py-1 text-danger hover:bg-darkHover",children:[t.jsx(ve,{size:20}),"Delete"]})]});function es(){const{downloadFilesAndFolders:e,updateDirectory:n}=W(),{viewHeight:s}=U(),{minHeightReached:r}=U(),[o,i]=a.useState(!1),u=async()=>{try{if(i(!0),"showDirectoryPicker"in window){const x=await window.showDirectoryPicker();await l(x);return}if("webkitdirectory"in HTMLInputElement.prototype){const x=document.createElement("input");x.type="file",x.webkitdirectory=!0,x.onchange=async f=>{const h=f.target.files;if(h){const m=await d(h);n("",m)}},x.click();return}R.error("Your browser does not support directory selection.")}catch(x){console.error("Error opening directory:",x),R.error("Failed to open directory")}finally{i(!1)}},l=async x=>{try{R.loading("Getting files and folders...");const f=await c(x);n("",f),R.dismiss(),R.success("Directory loaded successfully")}catch(f){console.error("Error processing directory:",f),R.error("Failed to process directory")}},c=async x=>{const f=[],h=["node_modules",".git",".vscode",".next"];for await(const m of x.values())if(m.kind==="file"){const E=await m.getFile(),S={id:H(),name:m.name,type:"file",content:await p(E)};f.push(S)}else if(m.kind==="directory"){if(h.includes(m.name))continue;const E={id:H(),name:m.name,type:"directory",children:await c(m),isOpen:!1};f.push(E)}return f},d=async x=>{const f=[],h=["node_modules",".git",".vscode",".next"];for(let m=0;m<x.length;m++){const E=x[m],S=E.webkitRelativePath.split("/");if(!S.some(C=>h.includes(C)))if(S.length>1){const C=S.slice(0,-1).join("/");if(f.findIndex(P=>P.name===C&&P.type==="directory")===-1){const P={id:H(),name:C,type:"directory",children:[],isOpen:!1};f.push(P)}const A={id:H(),name:E.name,type:"file",content:await p(E)},z=f.find(P=>P.name===C&&P.type==="directory");z&&z.children&&z.children.push(A)}else{const C={id:H(),name:E.name,type:"file",content:await p(E)};f.push(C)}}return f},p=async x=>{if(x.size>1048576)return`File too large: ${x.name} (${Math.round(x.size/1024)}KB)`;try{return await x.text()}catch(h){return console.error(`Error reading file ${x.name}:`,h),`Error reading file: ${x.name}`}};return t.jsxs("div",{className:"flex select-none flex-col gap-1 px-4 py-2",style:{height:s,maxHeight:s},children:[t.jsx(Qn,{}),t.jsxs("div",{className:ee("flex min-h-fit flex-col justify-end pt-2",{hidden:r}),children:[t.jsx("hr",{}),t.jsxs("button",{className:"mt-2 flex w-full justify-start rounded-md p-2 transition-all hover:bg-darkHover",onClick:u,disabled:o,children:[t.jsx(it,{className:"mr-2",size:24}),o?"Loading...":"Open File/Folder"]}),t.jsxs("button",{className:"flex w-full justify-start rounded-md p-2 transition-all hover:bg-darkHover",onClick:e,children:[t.jsx(at,{className:"mr-2",size:22})," Download Code"]})]})]})}const ts="https://emkc.org/api/v2/piston",we=je.create({baseURL:ts,headers:{"Content-Type":"application/json"}}),Ge=a.createContext(null),ns=()=>{const e=a.useContext(Ge);if(e===null)throw new Error("useRunCode must be used within a RunCodeContextProvider");return e},ss=({children:e})=>{const{activeFile:n}=W(),[s,r]=a.useState(""),[o,i]=a.useState(""),[u,l]=a.useState(!1),[c,d]=a.useState([]),[p,x]=a.useState({language:"",version:"",aliases:[]});a.useEffect(()=>{(async()=>{var E,S;try{const C=await we.get("/runtimes");d(C.data)}catch(C){k.error("Failed to fetch supported languages"),(E=C==null?void 0:C.response)!=null&&E.data&&console.error((S=C==null?void 0:C.response)==null?void 0:S.data)}})()},[]),a.useEffect(()=>{if(c.length===0||!(n!=null&&n.name))return;const m=n.name.split(".").pop();if(m){const E=Se.languages(m),S=c.find(C=>C.aliases.includes(m)||E.includes(C.language.toLowerCase()));S&&x(S)}else x({language:"",version:"",aliases:[]})},[n==null?void 0:n.name,c]);const f=async()=>{var m;try{if(p)if(n)if(n.content)k.loading("Running code...");else return k.error("File is empty");else return k.error("Please open a file to run the code");else return k.error("Please select a language to run the code");if(l(!0),p.language.toLowerCase()==="python")try{const T=await h(n.content,s);T.success===!1?i(T.error||"Execution failed"):i(T.output||"Program executed successfully (no output)"),l(!1),k.dismiss();return}catch{console.warn("CoderPoint failed, falling back to Piston")}const{language:E,version:S}=p,C=await we.post("/execute",{language:E,version:S,files:[{name:n.name,content:n.content}],stdin:s});C.data.run.stderr?i(C.data.run.stderr):i(C.data.run.stdout),l(!1),k.dismiss()}catch(E){console.error(((m=E.response)==null?void 0:m.data)||E.message),l(!1),k.dismiss(),k.error("Failed to run the code")}},h=async(m,E="")=>{try{const S=await fetch("https://cloud.coderpoint.ru/api/execute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:m,input:E,language:"python"})});if(!S.ok)throw new Error(`HTTP error! status: ${S.status}`);return await S.json()}catch(S){throw console.error("CoderPoint execution error:",S),S}};return t.jsx(Ge.Provider,{value:{setInput:r,output:o,isRunning:u,supportedLanguages:c,selectedLanguage:p,setSelectedLanguage:x,runCode:f},children:e})};function rs(){const{viewHeight:e}=U(),{setInput:n,output:s,isRunning:r,supportedLanguages:o,selectedLanguage:i,setSelectedLanguage:u,runCode:l}=ns(),c=p=>{const x=JSON.parse(p.target.value);u(x)},d=()=>{navigator.clipboard.writeText(s),k.success("Output copied to clipboard")};return t.jsxs("div",{className:"flex flex-col items-center gap-2 p-4",style:{height:e},children:[t.jsx("h1",{className:"view-title",children:"Run Code"}),t.jsxs("div",{className:"flex h-[90%] w-full flex-col items-end gap-2 md:h-[92%]",children:[t.jsxs("div",{className:"relative w-full",children:[t.jsx("select",{className:"w-full rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",value:JSON.stringify(i),onChange:c,children:o.sort((p,x)=>p.language>x.language?1:-1).map((p,x)=>t.jsx("option",{value:JSON.stringify(p),children:p.language+(p.version?` (${p.version})`:"")},x))}),t.jsx(Ee,{size:16,className:"absolute bottom-3 right-4 z-10 text-white"})]}),t.jsx("textarea",{className:"min-h-[120px] w-full resize-none rounded-md border-none bg-darkHover p-2 text-white outline-none",placeholder:"Write you input here...",onChange:p=>n(p.target.value)}),t.jsx("button",{className:"flex w-full justify-center rounded-md bg-primary p-2 font-bold text-black outline-none disabled:cursor-not-allowed disabled:opacity-50",onClick:l,disabled:r,children:"Run"}),t.jsxs("label",{className:"flex w-full justify-between",children:["Output :",t.jsx("button",{onClick:d,title:"Copy Output",children:t.jsx(ue,{size:18,className:"cursor-pointer text-white"})})]}),t.jsx("div",{className:"w-full flex-grow resize-none overflow-y-auto rounded-md border-none bg-darkHover p-2 text-white outline-none",children:t.jsx("code",{children:t.jsx("pre",{className:"text-wrap",children:s})})})]})]})}function ce({onChange:e,value:n,options:s,title:r}){return t.jsxs("div",{className:"relative w-full",children:[t.jsx("label",{className:"mb-2",children:r}),t.jsx("select",{className:"w-full rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",value:n,onChange:e,children:s.sort().map(o=>{const i=o,u=o.charAt(0).toUpperCase()+o.slice(1);return t.jsx("option",{value:i,children:u},u)})}),t.jsx(Ee,{size:16,className:"absolute bottom-3 right-4 z-10 text-white"})]})}const os=["Anonymous Pro","Cousine","Fira Code","Inconsolata","JetBrains Mono","Jura","Roboto Mono","Source Code Pro","Space Mono","Ubuntu Mono"],$e={Abcdef:pn,Abyss:fn,"Android Studio":mn,Andromeda:dn,"Atom One":un,Aura:cn,"Basic Dark":ln,"Basic Light":an,BBEdit:on,Bespin:rn,Copilot:sn,Darcula:nn,Dracula:tn,"Duotone Dark":en,"Duotone Light":Zt,Eclipse:Kt,"GitHub Dark":Xt,"GitHub Light":Qt,"Gruvbox Dark":qt,"Gruvbox Light":Bt,Kimbie:Vt,Material:Jt,"Material Dark":Wt,"Material Light":Yt,Monokai:$t,"Monokai Dimmed":Gt,"Noctis Lilac":Ht,Nord:zt,Okaidia:Ut,"Quiet Light":Mt,Red:_t,"Solarized Dark":Pt,"Solarized Light":At,Sublime:Ft,"Tokyo Night":Ot,"Tokyo Night Day":Tt,"Tokyo Night Storm":Lt,"Tomorrow Night Blue":Rt,"VS Code Dark":It,"White Dark":kt,"White Light":Dt,"Xcode Dark":St,"Xcode Light":Nt};function is(){const{theme:e,setTheme:n,language:s,setLanguage:r,fontSize:o,setFontSize:i,fontFamily:u,setFontFamily:l,showGitHubCorner:c,setShowGitHubCorner:d,resetSettings:p}=re(),{viewHeight:x}=U(),f=C=>l(C.target.value),h=C=>n(C.target.value),m=C=>r(C.target.value),E=C=>i(parseInt(C.target.value)),S=C=>d(C.target.checked);return a.useEffect(()=>{const C=document.querySelector(".cm-editor > .cm-scroller");C!==null&&(C.style.fontFamily=`${u}, monospace`)},[u]),t.jsxs("div",{className:"flex flex-col items-center gap-2 p-4",style:{height:x},children:[t.jsx("h1",{className:"view-title",children:"Settings"}),t.jsxs("div",{className:"flex w-full items-end gap-2",children:[t.jsx(ce,{onChange:f,value:u,options:os,title:"Font Family"}),t.jsx("select",{value:o,onChange:E,className:"rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",title:"Font Size",children:[...Array(13).keys()].map(C=>t.jsx("option",{value:C+12,children:C+12},C))})]}),t.jsx(ce,{onChange:h,value:e,options:Object.keys($e),title:"Theme"}),t.jsx(ce,{onChange:m,value:s,options:hn,title:"Language"}),t.jsxs("div",{className:"mt-4 flex w-full items-center justify-between",children:[t.jsx("label",{children:"Show github corner"}),t.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[t.jsx("input",{className:"peer sr-only",type:"checkbox",onChange:S,checked:c}),t.jsx("div",{className:"peer h-6 w-12 rounded-full bg-darkHover outline-none duration-100 after:absolute after:left-1 after:top-1 after:flex after:h-4 after:w-4 after:items-center after:justify-center after:rounded-full after:bg-white after:font-bold after:outline-none after:duration-500 peer-checked:after:translate-x-6 peer-checked:after:border-white peer-focus:outline-none"})]})]}),t.jsx("button",{className:"mt-auto w-full rounded-md border-none bg-darkHover px-4 py-2 text-white outline-none",onClick:p,children:"Reset to default"})]})}function as(){const{users:e}=_();return t.jsx("div",{className:"flex min-h-[200px] flex-grow justify-center overflow-y-auto py-2",children:t.jsx("div",{className:"flex h-full w-full flex-wrap items-start gap-x-2 gap-y-6",children:e.map(n=>t.jsx(ls,{user:n},n.socketId))})})}const ls=({user:e})=>{const{username:n,status:s}=e,r=`${n} - ${s===se.ONLINE?"online":"offline"}`;return t.jsxs("div",{className:"relative flex w-[100px] flex-col items-center gap-2",title:r,children:[t.jsx(Cn,{name:n,size:"50",round:"12px",title:r}),t.jsx("p",{className:"line-clamp-2 max-w-full text-ellipsis break-words",children:n}),t.jsx("div",{className:`absolute right-5 top-0 h-3 w-3 rounded-full ${s===se.ONLINE?"bg-green-500":"bg-danger"}`})]})};function cs(){const e=ie(),{viewHeight:n}=U(),{setStatus:s}=_(),{socket:r}=G(),o=async()=>{const l=window.location.href;try{await navigator.clipboard.writeText(l),k.success("URL copied to clipboard")}catch(c){k.error("Unable to copy URL to clipboard"),console.log(c)}},i=async()=>{const l=window.location.href;try{await navigator.share({url:l})}catch(c){k.error("Unable to share URL"),console.log(c)}},u=()=>{r.disconnect(),s(M.DISCONNECTED),e("/",{replace:!0})};return t.jsxs("div",{className:"flex flex-col p-4",style:{height:n},children:[t.jsx("h1",{className:"view-title",children:"Users"}),t.jsx(as,{}),t.jsx("div",{className:"flex flex-col items-center gap-4 pt-4",children:t.jsxs("div",{className:"flex w-full gap-4",children:[t.jsx("button",{className:"flex flex-grow items-center justify-center rounded-md bg-white p-3 text-black",onClick:i,title:"Share Link",children:t.jsx(lt,{size:26})}),t.jsx("button",{className:"flex flex-grow items-center justify-center rounded-md bg-white p-3 text-black",onClick:o,title:"Copy Link",children:t.jsx(ue,{size:22})}),t.jsx("button",{className:"flex flex-grow items-center justify-center rounded-md bg-primary p-3 text-black",onClick:u,title:"Leave room",children:t.jsx(ct,{size:22})})]})})]})}var I=(e=>(e.FILES="FILES",e.CHATS="CHATS",e.CLIENTS="CLIENTS",e.RUN="RUN",e.COPILOT="COPILOT",e.SETTINGS="SETTINGS",e))(I||{});const Ye=a.createContext(null),ae=()=>{const e=a.useContext(Ye);if(!e)throw new Error("useViews must be used within a ViewContextProvider");return e};function us({children:e}){const{isMobile:n}=Q(),[s,r]=a.useState(I.FILES),[o,i]=a.useState(!n),[u]=a.useState({[I.FILES]:t.jsx(es,{}),[I.CLIENTS]:t.jsx(cs,{}),[I.SETTINGS]:t.jsx(is,{}),[I.COPILOT]:t.jsx(qn,{}),[I.CHATS]:t.jsx(zn,{}),[I.RUN]:t.jsx(rs,{})}),[l]=a.useState({[I.FILES]:t.jsx(ht,{size:28}),[I.CLIENTS]:t.jsx(pt,{size:30}),[I.SETTINGS]:t.jsx(ft,{size:28}),[I.CHATS]:t.jsx(mt,{size:30}),[I.COPILOT]:t.jsx(dt,{size:28}),[I.RUN]:t.jsx(ut,{size:28})});return t.jsx(Ye.Provider,{value:{activeView:s,setActiveView:r,isSidebarOpen:o,setIsSidebarOpen:i,viewComponents:u,viewIcons:l},children:e})}function ds({children:e}){const{isSidebarOpen:n}=ae(),{isMobile:s,width:r}=Q(),{setItem:o,getItem:i}=Ie(),u=()=>{const f=document.createElement("div");return f.className="h-full cursor-e-resizer hidden md:block",f.style.backgroundColor="#e1e1ffb3",f},l=()=>{if(s)return[0,r];const f=i("editorSizes");let h=[35,65];return f&&(h=JSON.parse(f)),n?h:[0,r]},c=()=>s?[0,r]:n?[350,350]:[50,0],d=()=>s?[0,1/0]:n?[1/0,1/0]:[0,1/0],p=f=>{o("editorSizes",JSON.stringify(f))},x=()=>({width:"7px",display:n&&!s?"block":"none"});return t.jsx(En,{sizes:l(),minSize:c(),gutter:u,maxSize:d(),dragInterval:1,direction:"horizontal",gutterAlign:"center",cursor:"e-resize",snapOffset:30,gutterStyle:x,onDrag:p,className:"flex h-screen min-h-screen max-w-full items-center justify-center overflow-hidden",children:e})}function ms(){return t.jsx("div",{className:"flex h-screen min-h-screen flex-col items-center justify-center gap-6 px-4 text-center",children:t.jsx(fs,{})})}const fs=()=>{const e=ie(),n=()=>{window.location.reload()},s=()=>{e("/")};return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"whitespace-break-spaces text-lg font-medium text-slate-300",children:"Oops! Something went wrong. Please try again"}),t.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[t.jsx("button",{className:"mr-4 rounded-md bg-primary px-8 py-2 font-bold text-black",onClick:n,children:"Try Again"}),t.jsx("button",{className:"rounded-md bg-primary px-8 py-2 font-bold text-black",onClick:s,children:"Go to HomePage"})]})]})},We={backgroundColor:"#e0e0e0",padding:"8px 12px",borderRadius:"6px",color:"#000",fontSize:"12px",fontWeight:"500",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},ye={base:"relative flex items-center justify-center rounded transition-colors duration-200 ease-in-out p-2",hover:"hover:bg-[#3D404A]"},Z=({viewName:e,icon:n})=>{const{activeView:s,setActiveView:r,isSidebarOpen:o,setIsSidebarOpen:i}=ae(),{isNewMessage:u}=me(),[l,c]=a.useState(!0),d=p=>{p===s?i(!o):(i(!0),r(p))};return t.jsxs("div",{className:"relative flex flex-col items-center",children:[t.jsxs("button",{onClick:()=>d(e),onMouseEnter:()=>c(!0),className:`${ye.base} ${ye.hover}`,...l&&{"data-tooltip-id":`tooltip-${e}`,"data-tooltip-content":e},children:[t.jsx("div",{className:"flex items-center justify-center",children:n}),e===I.CHATS&&u&&t.jsx("div",{className:"absolute right-0 top-0 h-3 w-3 rounded-full bg-primary"})]}),l&&t.jsx(ke,{id:`tooltip-${e}`,place:"right",offset:25,className:"!z-50",style:We,noArrow:!1,positionStrategy:"fixed",float:!0})]})};function ps(){const{activeView:e,isSidebarOpen:n,viewComponents:s,viewIcons:r,setIsSidebarOpen:o}=ae(),{minHeightReached:i}=U(),{activityState:u,setActivityState:l}=_(),{socket:c}=G(),{isMobile:d}=Q(),[p,x]=a.useState(!0),f=()=>{x(!1),u===Y.CODING?(l(Y.DRAWING),c.emit(w.REQUEST_DRAWING)):l(Y.CODING),d&&o(!1)};return t.jsxs("aside",{className:"flex w-full md:h-full md:max-h-full md:min-h-full md:w-auto",children:[t.jsxs("div",{className:ee("fixed bottom-0 left-0 z-50 flex h-[50px] w-full gap-4 self-end overflow-hidden border-t border-darkHover bg-dark p-2 md:static md:h-full md:w-[50px] md:min-w-[50px] md:flex-col md:border-r md:border-t-0 md:p-2 md:pt-4",{hidden:i}),children:[t.jsx(Z,{viewName:I.FILES,icon:r[I.FILES]}),t.jsx(Z,{viewName:I.CHATS,icon:r[I.CHATS]}),t.jsx(Z,{viewName:I.COPILOT,icon:r[I.COPILOT]}),t.jsx(Z,{viewName:I.RUN,icon:r[I.RUN]}),t.jsx(Z,{viewName:I.CLIENTS,icon:r[I.CLIENTS]}),t.jsx(Z,{viewName:I.SETTINGS,icon:r[I.SETTINGS]}),t.jsxs("div",{className:"flex h-fit items-center justify-center",children:[t.jsx("button",{className:"justify-cente flex items-center  rounded p-1.5 transition-colors duration-200 ease-in-out hover:bg-[#3D404A]",onClick:f,onMouseEnter:()=>x(!0),"data-tooltip-id":"activity-state-tooltip","data-tooltip-content":u===Y.CODING?"Switch to Drawing Mode":"Switch to Coding Mode",children:u===Y.CODING?t.jsx(gt,{size:30}):t.jsx(xt,{size:30})}),p&&t.jsx(ke,{id:"activity-state-tooltip",place:"right",offset:15,className:"!z-50",style:We,noArrow:!1,positionStrategy:"fixed",float:!0})]})]}),t.jsx("div",{className:"absolute left-0 top-0 z-20 w-full flex-col bg-dark md:static md:min-w-[300px]",style:n?{}:{display:"none"},children:s[e]})]})}function hs(){const{isMobile:e}=Q();return t.jsx(Nn,{inferDarkMode:!0,forceMobile:e,defaultName:"Editor",className:"z-0",children:t.jsx(gs,{})})}function gs(){const e=jn(),{drawingData:n,setDrawingData:s}=_(),{socket:r}=G(),o=a.useCallback(u=>{const l=u.changes;s(e.store.getSnapshot()),r.emit(w.DRAWING_UPDATE,{snapshot:l})},[e.store,s,r]),i=a.useCallback(({snapshot:u})=>{e.store.mergeRemoteChanges(()=>{const{added:l,updated:c,removed:d}=u;for(const p of Object.values(l))e.store.put([p]);for(const[,p]of Object.values(c))e.store.put([p]);for(const p of Object.values(d))e.store.remove([p.id])}),s(e.store.getSnapshot())},[e.store,s]);return a.useEffect(()=>{n&&Object.keys(n).length>0&&e.store.loadSnapshot(n)},[]),a.useEffect(()=>{const u=e.store.listen(o,{source:"user",scope:"document"});return r.on(w.DRAWING_UPDATE,i),()=>{u(),r.off(w.DRAWING_UPDATE)}},[n,e.store,o,i,r]),null}function xs(){const{fontSize:e,setFontSize:n}=re();a.useEffect(()=>{const s=r=>{const o="Changes you made may not be saved";return r.returnValue=o};return window.addEventListener("beforeunload",s),()=>{window.removeEventListener("beforeunload",s)}},[]),a.useEffect(()=>{const s=r=>{if(r.ctrlKey){if(r.preventDefault(),!r.target.closest(".cm-editor"))return;r.deltaY>0?n(Math.max(e-1,12)):n(Math.min(e+1,24))}};return window.addEventListener("wheel",s,{passive:!1}),()=>{window.removeEventListener("wheel",s)}},[e,n])}const Je=Sn.define();function Ve(e){const n=["#FF0000","#008080","#0000FF","#008000","#FFD700","#800080","#00CED1","#FFA500","#9932CC","#1E90FF"];let s=0;for(let r=0;r<e.length;r++)s=e.charCodeAt(r)+((s<<5)-s);return n[Math.abs(s)%n.length]}class ws extends kn{constructor(n){super(),this.user=n}eq(n){return this.user.username===n.user.username&&this.user.typing===n.user.typing}toDOM(){const n=Ve(this.user.username),s=document.createElement("span");s.className="cm-remote-cursor",s.style.cssText=`
            position: absolute;
            width: 2px;
            height: 1.2em;
            background-color: ${n};
            border-radius: 1px;
            pointer-events: none;
            z-index: 10;
            animation: cursor-blink 1s infinite;
        `;const r=document.createElement("span");return r.className="cm-remote-cursor-label",r.textContent=this.user.username,r.style.cssText=`
            position: absolute;
            top: -20px;
            left: 0;
            background-color: ${n};
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: 500;
            white-space: nowrap;
            pointer-events: none;
            z-index: 11;
            opacity: ${this.user.typing?"1":"0.7"};
            transition: opacity 0.3s ease;
        `,s.appendChild(r),s}}function ys(e,n){return oe.widget({widget:new ws(e),side:1}).range(n)}function Cs(e,n,s){const r=Ve(e.username);return oe.mark({class:"cm-remote-selection",attributes:{style:`
                background-color: ${r}33;
                border-left: 2px solid ${r};
                border-radius: 2px;
            `}}).range(n,s)}const bs=Dn.define({create(){return oe.none},update(e,n){e=e.map(n.changes);for(const s of n.effects)if(s.is(Je)){const r=s.value,o=[];for(const i of r)if(!(!i.typing&&!i.selectionStart&&!i.selectionEnd)){if(i.selectionStart!==void 0&&i.selectionEnd!==void 0&&i.selectionStart!==i.selectionEnd){const u=Math.min(i.selectionStart,n.newDoc.length),l=Math.min(i.selectionEnd,n.newDoc.length);u<l&&o.push(Cs(i,u,l))}if(i.cursorPosition>=0){const u=Math.min(i.cursorPosition,n.newDoc.length);o.push(ys(i,u))}}return o.sort((i,u)=>{var p,x,f,h;const l=i.from-u.from;if(l!==0)return l;const c=((x=(p=i.value)==null?void 0:p.spec)==null?void 0:x.startSide)||0,d=((h=(f=u.value)==null?void 0:f.spec)==null?void 0:h.startSide)||0;return c-d}),oe.set(o,!0)}return e},provide:e=>de.decorations.from(e)}),vs=de.baseTheme({".cm-remote-cursor":{position:"relative",display:"inline-block"},".cm-remote-selection":{position:"relative"},"@keyframes cursor-blink":{"0%, 50%":{opacity:"1"},"51%, 100%":{opacity:"0"}}});function Es(){return[bs,vs]}function js(){const{users:e,currentUser:n}=_(),{activeFile:s,setActiveFile:r}=W(),{theme:o,language:i,fontSize:u}=re(),{socket:l}=G(),{viewHeight:c}=U(),[d,p]=a.useState(setTimeout(()=>{},0)),x=a.useMemo(()=>e.filter(L=>L.username!==n.username),[e,n]),[f,h]=a.useState([]),m=a.useRef(null),[E,S]=a.useState(0),[C,T]=a.useState({}),A=a.useRef(null),z=(L,O)=>{var B,te;if(!s)return;const J={...s,content:L};r(J);const F=(te=(B=O.state)==null?void 0:B.selection)==null?void 0:te.main,V=(F==null?void 0:F.head)||0,X=F==null?void 0:F.from,K=F==null?void 0:F.to;l.emit(w.TYPING_START,{cursorPosition:V,selectionStart:X,selectionEnd:K}),l.emit(w.FILE_UPDATED,{fileId:s.id,newContent:L}),clearTimeout(d);const q=setTimeout(()=>l.emit(w.TYPING_PAUSE),1e3);p(q)},P=a.useCallback(L=>{var q,B;if(!L.selectionSet)return;const O=(B=(q=L.state)==null?void 0:q.selection)==null?void 0:B.main,J=(O==null?void 0:O.head)||0,F=O==null?void 0:O.from,V=O==null?void 0:O.to,X=J!==E,K=F!==C.start||V!==C.end;(X||K)&&(S(J),T({start:F,end:V}),A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{l.emit(w.CURSOR_MOVE,{cursorPosition:J,selectionStart:F,selectionEnd:V})},100))},[E,C,l]);return xs(),a.useEffect(()=>{const L=[gn,xn,Es(),de.updateListener.of(P),In()],O=wn(i.toLowerCase());O?L.push(O):k.error("Syntax highlighting is unavailable for this language. Please adjust the editor settings; it may be listed under a different name.",{duration:5e3}),h(L)},[x,i,P]),a.useEffect(()=>{var L;(L=m.current)!=null&&L.view&&m.current.view.dispatch({effects:Je.of(x)})},[x]),t.jsx(yn,{ref:m,theme:$e[o],onChange:z,value:s==null?void 0:s.content,extensions:f,minHeight:"100%",maxWidth:"100vw",style:{fontSize:u+"px",height:c,position:"relative"}})}const Ce={php:"php",phtml:"php",php3:"php",php4:"php",php5:"php",php7:"php",phps:"php",cs:"csharp",csx:"csharp",js:"javascript",jsx:"javascript",mjs:"javascript",cjs:"javascript",ts:"typescript",tsx:"typescript",mts:"typescript",cts:"typescript",java:"java",jsp:"java",py:"python",pyw:"python",pyi:"python",pyx:"python",c:"c",h:"c",cpp:"cpp",cxx:"cpp",cc:"cpp",hpp:"cpp",hxx:"cpp",hh:"cpp",html:"html",htm:"html",xhtml:"html",css:"css",scss:"scss",sass:"sass",less:"less",md:"markdown",markdown:"markdown",mdx:"markdown",json:"json",xml:"xml",xsd:"xml",xsl:"xml",xslt:"xml",yaml:"yaml",yml:"yaml",sql:"sql",sh:"shell",bash:"shell",zsh:"shell",fish:"shell",ps1:"powershell",psm1:"powershell",psd1:"powershell",rb:"ruby",rbx:"ruby",rjs:"ruby",rake:"ruby",go:"go",rs:"rust",swift:"swift",kt:"kotlin",kts:"kotlin",scala:"scala",sc:"scala",dart:"dart",lua:"lua",pl:"perl",pm:"perl",t:"perl",r:"r",R:"r",m:"objectivec",mm:"objectivec",vue:"vue",svelte:"svelte",component:"typescript",env:"shell",gitignore:"shell",dockerignore:"shell",editorconfig:"shell",dockerfile:"dockerfile",mk:"makefile",make:"makefile",makefile:"makefile",txt:"text",text:"text",csv:"csv",tsv:"tsv",log:"text",ini:"ini",cfg:"ini",conf:"ini",toml:"toml",graphql:"graphql",gql:"graphql",prisma:"prisma",proto:"protobuf",tex:"latex",sty:"latex",cls:"latex",bib:"bibtex",matlab:"matlab",ino:"arduino",asm:"assembly",s:"assembly",S:"assembly",f:"fortran",for:"fortran",f90:"fortran",f95:"fortran",hs:"haskell",lhs:"haskell",ex:"elixir",exs:"elixir",erl:"erlang",hrl:"erlang",clj:"clojure",cljs:"clojure",cljc:"clojure",groovy:"groovy",gvy:"groovy",gy:"groovy",gsh:"groovy",jl:"julia",pas:"pascal",p:"pascal",pro:"prolog",vhd:"vhdl",vhdl:"vhdl",v:"verilog",sv:"verilog",cob:"cobol",cbl:"cobol"};function Ns(){const{openFiles:e,closeFile:n,activeFile:s,updateFileContent:r,setActiveFile:o}=W(),i=a.useRef(null),{setLanguage:u}=re(),l=c=>{if((s==null?void 0:s.id)===c)return;r((s==null?void 0:s.id)||"",(s==null?void 0:s.content)||"");const d=e.find(p=>p.id===c);d&&o(d)};return a.useEffect(()=>{const c=i.current;if(!c)return;const d=p=>{p.deltaY>0?c.scrollLeft+=100:c.scrollLeft-=100};return c.addEventListener("wheel",d),()=>{c.removeEventListener("wheel",d)}},[]),a.useEffect(()=>{if((s==null?void 0:s.name)===void 0)return;const c=s.name.split(".").pop();if(!c)return;if(Ce[c]){u(Ce[c]);return}const d=Se.languages(c);u(d[0])},[s==null?void 0:s.name,u]),t.jsx("div",{className:"flex h-[50px] w-full select-none gap-2 overflow-x-auto p-2 pb-0",ref:i,children:e.map(c=>t.jsxs("span",{className:ee("flex w-fit cursor-pointer items-center rounded-t-md px-2 py-1 text-white",{"bg-darkHover":c.id===(s==null?void 0:s.id)}),onClick:()=>l(c.id),children:[t.jsx(Ne,{icon:Ue(c.name),fontSize:22,className:"mr-2 min-w-fit"}),t.jsx("p",{className:"flex-grow cursor-pointer overflow-hidden truncate",title:c.name,children:c.name}),t.jsx(wt,{className:"ml-3 inline rounded-md hover:bg-darkHover",size:20,onClick:()=>n(c.id)})]},c.id))})}function Ss(){const{openFiles:e}=W(),{minHeightReached:n}=U();return e.length<=0?t.jsx("div",{className:"flex h-full w-full items-center justify-center",children:t.jsx("h1",{className:"text-xl text-white",children:"No file is currently open."})}):t.jsxs("main",{className:ee("flex w-full flex-col overflow-x-auto md:h-screen",{"h-[calc(100vh-50px)]":!n,"h-full":n}),children:[t.jsx(Ns,{}),t.jsx(js,{})]})}function Ds(){const{viewHeight:e}=U(),{activityState:n}=_();return t.jsx("div",{className:"absolute left-0 top-0 w-full max-w-full flex-grow overflow-x-hidden md:static",style:{height:e},children:n===Y.DRAWING?t.jsx(hs,{}):t.jsx(Ss,{})})}function ks(){function e(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(r=>navigator.userAgent.match(r))}const n=e();a.useEffect(()=>{n&&ge.isEnabled&&ge.request()},[n])}function Is(){const{setUsers:e}=_(),{socket:n}=G(),s=a.useCallback(()=>{document.visibilityState==="visible"?n.emit(w.USER_ONLINE,{socketId:n.id}):document.visibilityState==="hidden"&&n.emit(w.USER_OFFLINE,{socketId:n.id})},[n]),r=a.useCallback(({socketId:u})=>{e(l=>l.map(c=>c.socketId===u?{...c,status:se.ONLINE}:c))},[e]),o=a.useCallback(({socketId:u})=>{e(l=>l.map(c=>c.socketId===u?{...c,status:se.OFFLINE}:c))},[e]),i=a.useCallback(({user:u})=>{e(l=>l.map(c=>c.socketId===u.socketId?u:c))},[e]);a.useEffect(()=>(document.addEventListener("visibilitychange",s),n.on(w.USER_ONLINE,r),n.on(w.USER_OFFLINE,o),n.on(w.TYPING_START,i),n.on(w.TYPING_PAUSE,i),n.on(w.CURSOR_MOVE,i),()=>{document.removeEventListener("visibilitychange",s),n.off(w.USER_ONLINE),n.off(w.USER_OFFLINE),n.off(w.TYPING_START),n.off(w.TYPING_PAUSE),n.off(w.CURSOR_MOVE)}),[n,e,s,r,o,i])}function Rs(){var l;Is(),ks();const e=ie(),{roomId:n}=bn(),{status:s,setCurrentUser:r,currentUser:o}=_(),{socket:i}=G(),u=De();return a.useEffect(()=>{var d;if(o.username.length>0)return;const c=(d=u.state)==null?void 0:d.username;if(c===void 0)e("/",{state:{roomId:n}});else if(n){const p={username:c,roomId:n};r(p),i.emit(w.JOIN_REQUEST,p)}},[o.username,(l=u.state)==null?void 0:l.username,e,n,r,i]),s===M.CONNECTION_FAILED?t.jsx(ms,{}):t.jsxs(ds,{children:[t.jsx(ps,{}),t.jsx(Ds,{})]})}const Ls="/assets/illustration-Azuc-YCm.svg",Ts="/assets/logo-eD4nMjT1.svg",Os=()=>{var f,h;const e=De(),{currentUser:n,setCurrentUser:s,status:r,setStatus:o}=_(),{socket:i}=G(),u=a.useRef(null),l=ie(),c=()=>{var m;s({...n,roomId:H()}),R.success("Created a new Room Id"),(m=u.current)==null||m.focus()},d=m=>{const E=m.target.name,S=m.target.value;s({...n,[E]:S})},p=()=>n.username.trim().length===0?(R.error("Enter your username"),!1):n.roomId.trim().length===0?(R.error("Enter a room id"),!1):n.roomId.trim().length<5?(R.error("ROOM Id must be at least 5 characters long"),!1):n.username.trim().length<3?(R.error("Username must be at least 3 characters long"),!1):!0,x=m=>{m.preventDefault(),r!==M.ATTEMPTING_JOIN&&p()&&(R.loading("Joining room..."),o(M.ATTEMPTING_JOIN),i.emit(w.JOIN_REQUEST,n))};return a.useEffect(()=>{var m;n.roomId.length>0||(m=e.state)!=null&&m.roomId&&(s({...n,roomId:e.state.roomId}),n.username.length===0&&R.success("Enter your username"))},[n,(f=e.state)==null?void 0:f.roomId,s]),a.useEffect(()=>{if(r===M.DISCONNECTED&&!i.connected){i.connect();return}const m=sessionStorage.getItem("redirect")||!1;if(r===M.JOINED&&!m){const E=n.username;sessionStorage.setItem("redirect","true"),l(`/editor/${n.roomId}`,{state:{username:E}})}else r===M.JOINED&&m&&(sessionStorage.removeItem("redirect"),o(M.DISCONNECTED),i.disconnect(),i.connect())},[n,(h=e.state)==null?void 0:h.redirect,l,o,i,r]),t.jsxs("div",{className:"flex w-full max-w-[500px] flex-col items-center justify-center gap-4 p-4 sm:w-[500px] sm:p-8",children:[t.jsx("img",{src:Ts,alt:"Logo",className:"w-full"}),t.jsxs("form",{onSubmit:x,className:"flex w-full flex-col gap-4",children:[t.jsx("input",{type:"text",name:"roomId",placeholder:"Room Id",className:"w-full rounded-md border border-gray-500 bg-darkHover px-3 py-3 focus:outline-none",onChange:d,value:n.roomId}),t.jsx("input",{type:"text",name:"username",placeholder:"Username",className:"w-full rounded-md border border-gray-500 bg-darkHover px-3 py-3 focus:outline-none",onChange:d,value:n.username,ref:u}),t.jsx("button",{type:"submit",className:"mt-2 w-full rounded-md bg-primary px-8 py-3 text-lg font-semibold text-black",children:"Join"})]}),t.jsx("button",{className:"cursor-pointer select-none underline",onClick:c,children:"Generate Unique Room Id"})]})};function Fs(){return t.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center gap-16",children:t.jsxs("div",{className:"my-12 flex h-full min-w-full flex-col items-center justify-evenly sm:flex-row sm:pt-0",children:[t.jsx("div",{className:"flex w-full animate-up-down justify-center sm:w-1/2 sm:pl-4",children:t.jsx("img",{src:Ls,alt:"Code Editor Illustration",className:"mx-auto w-[250px] sm:w-[400px]"})}),t.jsx("div",{className:"flex w-full items-center justify-center sm:w-1/2",children:t.jsx(Os,{})})]})})}const As=()=>t.jsxs(t.Fragment,{children:[t.jsx(qe,{children:t.jsxs(vn,{children:[t.jsx(he,{path:"/",element:t.jsx(Fs,{})}),t.jsx(he,{path:"/editor/:roomId",element:t.jsx(Rs,{})})]})}),t.jsx(Tn,{})," ",t.jsx(Ln,{})]});function Ps({children:e}){return t.jsx(On,{children:t.jsx(An,{children:t.jsx(Rn,{children:t.jsx(us,{children:t.jsx(Bn,{children:t.jsx(Yn,{children:t.jsx(ss,{children:t.jsx(Pn,{children:e})})})})})})})})}Be.createRoot(document.getElementById("root")).render(t.jsx(Ps,{children:t.jsx(As,{})}));
